(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    103929,       2918]
NotebookOptionsPosition[    100082,       2798]
NotebookOutlinePosition[    100419,       2813]
CellTagsIndexPosition[    100376,       2810]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "This", " ", "first", " ", "part", " ", "is", " ", "what", " ", "you", " ", 
   "already", " ", "know"}], "*)"}]], "Input",
 CellChangeTimes->{{3.599833518958549*^9, 3.599833532620428*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{
  "kt", ",", "u", ",", " ", "d", ",", "g", ",", "rs", ",", " ", "a", ",", " ",
    "b", ",", "x", ",", " ", "rho1", ",", "rho2", ",", "rho3", ",", " ", 
   "rhodash", ",", " ", "rhodash1", ",", " ", "rhodash2", ",", "rhodash3", 
   ",", " ", "lgs", ",", " ", "lgs1", ",", "lgs2", ",", " ", "lgs3", ",", 
   "lgs4", ",", "lgs5", ",", "lgs6", ",", "k", ",", "fk", ",", "kulim0", ",", 
   "kliminf", ",", "dk"}], "]"}]], "Input",
 CellChangeTimes->{{3.595672957593234*^9, 3.595673006761327*^9}, {
  3.5956733601640663`*^9, 3.595673374944994*^9}, {3.595681709729154*^9, 
  3.595681721566998*^9}, {3.595681858821155*^9, 3.5956818705649633`*^9}, {
  3.595682101731082*^9, 3.595682112045411*^9}, {3.595686649246356*^9, 
  3.595686663966963*^9}, {3.5957569986634493`*^9, 3.595757062008774*^9}, {
  3.595760655061489*^9, 3.595760655973249*^9}, {3.5998212773462887`*^9, 
  3.599821300722823*^9}, {3.599822643015068*^9, 3.599822643142292*^9}, {
  3.599832815603737*^9, 3.599832882947047*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"kt", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rs", " ", "=", " ", "1"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.595740973791575*^9, 3.59574098966707*^9}, {
   3.595743908635558*^9, 3.595743920651436*^9}, {3.595744562794986*^9, 
   3.5957445661228113`*^9}, 3.5957462102606707`*^9, {3.595746912086286*^9, 
   3.5957469161671457`*^9}, {3.595750531906595*^9, 3.595750534291719*^9}, {
   3.5957565232752333`*^9, 3.5957565263795652`*^9}, {3.595761687518742*^9, 
   3.595761690974024*^9}, 3.595763025216387*^9, {3.599808155960087*^9, 
   3.599808167847637*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Transition", " ", "matrix", " ", "for", " ", "Barrier"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.59983355416671*^9, 3.599833565501108*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "g"}], ",", "g"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"g", ",", 
       RowBox[{"-", "g"}]}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.595657075375264*^9, 3.595657127689218*^9}, {
   3.595657413262786*^9, 3.59565741524946*^9}, 3.595756528460301*^9, {
   3.599808180408759*^9, 3.599808187192994*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"evec", " ", "=", " ", 
   RowBox[{
    RowBox[{"Eigenvectors", "[", "w", "]"}], " ", "Use", " ", "hard", " ", 
    "coded", " ", "definition", " ", "instead", " ", "to", " ", "assure", " ",
     "correct", " ", "order", " ", "of", " ", "eigenvalues"}]}], " ", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.595657211927553*^9, 3.595657225716021*^9}, {
   3.595657299846554*^9, 3.595657304117014*^9}, 3.5956576290861597`*^9, {
   3.595745442641786*^9, 3.59574545993783*^9}, 3.5998230703674498`*^9, {
   3.599834072580595*^9, 3.599834094069807*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"evec", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.5998230774043016`*^9, 3.59982309386863*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.599823095003834*^9, 3.5998231200052967`*^9}, 
   3.599823241225052*^9, 3.599823452467702*^9, 3.59982414035155*^9, 
   3.599824879059228*^9, 3.599825100364509*^9, 3.5998326706870127`*^9, 
   3.5998329221662683`*^9, 3.599919026410306*^9, 3.599919529763033*^9, 
   3.599921857343656*^9, 3.600425661836631*^9, 3.601019019687632*^9, 
   3.601461883172852*^9, 3.60282726512961*^9, 3.602844280575263*^9, 
   3.603456675340766*^9, 3.603461878583027*^9, 3.603518419599948*^9, 
   3.603540377901952*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"s", " ", "=", " ", 
  RowBox[{"Transpose", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Normalize", "[", 
      RowBox[{"evec", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
     RowBox[{"Normalize", "[", 
      RowBox[{"evec", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "]"}], " "}]], "Input",\

 CellChangeTimes->{{3.595657261633478*^9, 3.595657294954088*^9}, 
   3.595657630636279*^9, 3.595756540042204*^9, {3.595757215532565*^9, 
   3.595757277598284*^9}, 3.5957573215686207`*^9, 3.59980840521316*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", 
      SqrtBox["2"]], ",", 
     RowBox[{"-", 
      FractionBox["1", 
       SqrtBox["2"]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", 
      SqrtBox["2"]], ",", 
     FractionBox["1", 
      SqrtBox["2"]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.599808405936059*^9, 3.599808569185286*^9, 3.5998103324857817`*^9, 
   3.599821304193632*^9, 3.599822279122032*^9, 3.5998226170352917`*^9, 
   3.599822649354431*^9, 3.599822729692905*^9, {3.599823098309209*^9, 
   3.599823120063314*^9}, 3.599823241264085*^9, 3.5998234524807*^9, 
   3.599824140389657*^9, 3.5998248791101427`*^9, 3.599825100412764*^9, 
   3.5998326707397547`*^9, 3.599832922211117*^9, 3.599919026453142*^9, 
   3.5999195297984953`*^9, 3.599921857372184*^9, 3.600425661875202*^9, 
   3.601019019729855*^9, 3.601461883271421*^9, 3.602827265133976*^9, 
   3.6028442805992393`*^9, 3.603456675379409*^9, 3.603461878626894*^9, 
   3.6035184196053467`*^9, 3.603540377938402*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"invs", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Assuming", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ab", ">", "0"}], ",", " ", 
       RowBox[{"ba", ">", "0"}]}], "}"}], ",", 
     RowBox[{"Inverse", "[", "s", "]"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.595657309660572*^9, 3.5956573341663837`*^9}, {
   3.595657464266329*^9, 3.595657514449798*^9}, 3.595657632806827*^9, {
   3.5956578097381697`*^9, 3.595657817547083*^9}, {3.595672428222034*^9, 
   3.595672431740897*^9}, 3.595756542380662*^9, 3.599808409019784*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", 
      SqrtBox["2"]], ",", 
     FractionBox["1", 
      SqrtBox["2"]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       SqrtBox["2"]]}], ",", 
     FractionBox["1", 
      SqrtBox["2"]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5998084098527737`*^9, 3.599808569237805*^9, 3.5998103325411987`*^9, 
   3.599821304240925*^9, 3.5998222791665173`*^9, 3.599822617073409*^9, 
   3.5998226493896313`*^9, 3.599822729726829*^9, {3.599823098361453*^9, 
   3.599823120115171*^9}, 3.599823241308383*^9, 3.5998234524991198`*^9, 
   3.599824140425048*^9, 3.599824879156424*^9, 3.599825100463249*^9, 
   3.599832670790936*^9, 3.599832922283422*^9, 3.5999190264973593`*^9, 
   3.59991952982718*^9, 3.5999218574048*^9, 3.6004256619168653`*^9, 
   3.601019019775364*^9, 3.601461883458763*^9, 3.602827265274517*^9, 
   3.60284428063019*^9, 3.6034566754780483`*^9, 3.6034618786800737`*^9, 
   3.603518419644309*^9, 3.603540377977893*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"diagw", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{"invs", ".", "w", ".", "s"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.595657350707673*^9, 3.5956573615273952`*^9}, {
  3.595657723983157*^9, 3.5956577320263443`*^9}, {3.595746160034775*^9, 
  3.595746175155512*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{"-", "2"}], " ", "g"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5956573629839697`*^9, 3.595657587836754*^9, 3.595657636048758*^9, 
   3.595657732652358*^9, 3.595657822297879*^9, {3.5956724100957003`*^9, 
   3.595672434497417*^9}, 3.595673011174543*^9, 3.595673207051647*^9, {
   3.5956732758962927`*^9, 3.595673289972418*^9}, 3.595673342820652*^9, 
   3.5956733788881693`*^9, 3.595681499128707*^9, 3.595681537854792*^9, {
   3.5956817254983873`*^9, 3.595681750319292*^9}, {3.595681811575921*^9, 
   3.5956818250366*^9}, {3.595681863718402*^9, 3.595681874888307*^9}, 
   3.5956819056015577`*^9, 3.595682078391672*^9, 3.595682114748328*^9, 
   3.595683296314979*^9, 3.595684884924906*^9, {3.595685645251309*^9, 
   3.595685664480011*^9}, 3.5956857905590963`*^9, 3.595686563191893*^9, {
   3.595686616617311*^9, 3.5956866374957933`*^9}, 3.5956866733877087`*^9, 
   3.59568672543683*^9, 3.595686758300777*^9, 3.5956868109505873`*^9, 
   3.59574068810813*^9, 3.595741220382844*^9, 3.595742212440875*^9, {
   3.595742276116745*^9, 3.5957422932183228`*^9}, 3.595742464392058*^9, 
   3.5957425833333607`*^9, 3.595742789133581*^9, 3.5957431059357862`*^9, 
   3.595743924942259*^9, 3.595744613749133*^9, 3.595744671929637*^9, 
   3.59574516162488*^9, {3.595745198223929*^9, 3.595745209668626*^9}, 
   3.595746164770648*^9, 3.5957462153062887`*^9, 3.595746257872816*^9, 
   3.595746921194475*^9, 3.595749007830089*^9, 3.5957504809730797`*^9, 
   3.595750643384984*^9, 3.595756010248398*^9, 3.595756308322382*^9, 
   3.595756461349291*^9, 3.595757038813458*^9, 3.595757282721115*^9, 
   3.595757874026867*^9, 3.595758895767358*^9, 3.595759181784416*^9, 
   3.595760615910853*^9, 3.595760851519779*^9, 3.59576101322821*^9, 
   3.595761151478529*^9, {3.595761520258437*^9, 3.5957615374771214`*^9}, 
   3.595761583048522*^9, 3.595761709587882*^9, 3.5957619855342007`*^9, 
   3.595763059653789*^9, 3.595930564008122*^9, 3.5959305989445143`*^9, 
   3.595930705007162*^9, {3.595930735481339*^9, 3.595930790827211*^9}, 
   3.595930851417368*^9, {3.595930890951048*^9, 3.595930919947854*^9}, {
   3.595931057525394*^9, 3.595931097212182*^9}, 3.599808229419106*^9, 
   3.599808415850216*^9, 3.599808569288419*^9, 3.599810332592043*^9, 
   3.5998213042858267`*^9, 3.5998222791702423`*^9, 3.599822617077301*^9, 
   3.599822649424945*^9, 3.5998227297298326`*^9, {3.599823098410866*^9, 
   3.599823120169031*^9}, 3.5998232413508987`*^9, 3.599823452510944*^9, 
   3.5998241404281054`*^9, 3.599824879159284*^9, 3.5998251005153103`*^9, 
   3.599832670846755*^9, 3.599832922287396*^9, 3.599919026557382*^9, 
   3.599919529853793*^9, 3.599921857407462*^9, 3.600425661957039*^9, 
   3.601019019779375*^9, 3.601461883472848*^9, 3.602827265308012*^9, 
   3.602844280633045*^9, 3.603456675535543*^9, 3.603461878687788*^9, 
   3.603518419673007*^9, 3.603540378018381*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Assembly", " ", "of", " ", "matching", " ", "matrix"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.5998335743142033`*^9, 3.599833599821673*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bcu", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"Exp", "[", 
       RowBox[{"u", "/", "kt"}], "]"}]}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.595671605269532*^9, 3.595671674034799*^9}, 
   3.595756546652924*^9, 3.5998084215328217`*^9, {3.59982486927284*^9, 
   3.599824875816165*^9}, {3.5998250530027847`*^9, 3.599825055963272*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     SuperscriptBox["\[ExponentialE]", "u"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5998084226323566`*^9, 3.599808569334751*^9, 3.599810332645546*^9, 
   3.599821304330974*^9, 3.599822279203157*^9, 3.599822617116536*^9, 
   3.59982264946426*^9, 3.599822729748211*^9, {3.599823098456915*^9, 
   3.599823120222021*^9}, 3.5998232413547*^9, 3.599823452521645*^9, 
   3.599824140457621*^9, 3.599824879189673*^9, 3.599825100553742*^9, 
   3.599832670897595*^9, 3.5998329223622637`*^9, 3.599919026602*^9, 
   3.599919529898782*^9, 3.599921857437594*^9, 3.600425662001915*^9, 
   3.60101901983617*^9, 3.601461883575743*^9, 3.6028272653420763`*^9, 
   3.602844280659477*^9, 3.6034566755902348`*^9, 3.603461878746036*^9, 
   3.603518419713612*^9, 3.6035403780912857`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Do", " ", "handy", " ", "substitutions", " ", "first", " ", "before", " ", 
   "things", " ", "get", " ", "out", " ", "of", " ", 
   RowBox[{"hand", "!"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.599833685336774*^9, 3.599833714750914*^9}, {
  3.599919031235887*^9, 3.59991903370004*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"rhodash", "[", "r_", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", " ", 
       RowBox[{"1", "/", "r"}], ",", " ", "0", ",", " ", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", " ", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"diagw", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}], "]"}], "/", "d"}], 
            "]"}]}], "r"}], "]"}], "/", "r"}], ",", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"diagw", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "2"}], "]"}], "]"}], "]"}], "/", "d"}], 
           "]"}], "r"}], "]"}], "/", "r"}]}], "}"}]}], "}"}], " ", "/.", 
   RowBox[{
    RowBox[{
     SqrtBox["2"], " ", 
     SqrtBox[
      FractionBox["1", "d"]], " ", 
     SqrtBox[
      RowBox[{"Abs", "[", "g", "]"}]]}], "\[Rule]", "x"}]}]}]], "Input",
 CellChangeTimes->{{3.5956811919885263`*^9, 3.595681212556374*^9}, {
   3.595681251398917*^9, 3.595681404681251*^9}, {3.5956814506624727`*^9, 
   3.595681452404071*^9}, {3.5956815118070927`*^9, 3.595681514116254*^9}, {
   3.5956818992078133`*^9, 3.595681900527905*^9}, {3.59568644384512*^9, 
   3.595686450266768*^9}, {3.595742452841593*^9, 3.5957424594828253`*^9}, {
   3.595743674663807*^9, 3.5957436767773523`*^9}, {3.595746249192492*^9, 
   3.5957462544721413`*^9}, {3.599808446909732*^9, 3.599808451870504*^9}, 
   3.599810309603199*^9, {3.59982311143978*^9, 3.599823117232072*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox["1", "r"], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     FractionBox[
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "r"}], " ", "x"}]], "r"], ",", 
     FractionBox[
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"r", " ", "x"}]], "r"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.595681383499846*^9, 3.59568140631944*^9}, 
   3.5956814536153307`*^9, {3.595681499180637*^9, 3.595681537941689*^9}, {
   3.595681725546722*^9, 3.595681750429289*^9}, {3.595681811687128*^9, 
   3.5956818251324244`*^9}, {3.595681863811881*^9, 3.5956818750757723`*^9}, 
   3.59568190570879*^9, 3.595682078490309*^9, 3.5956821148068523`*^9, 
   3.5956832964848413`*^9, 3.595684884989977*^9, {3.595685645389443*^9, 
   3.595685664591084*^9}, 3.5956857906944313`*^9, 3.595686563318461*^9, {
   3.595686616744152*^9, 3.595686637601632*^9}, 3.595686673526976*^9, 
   3.595686725551206*^9, 3.5956867583984127`*^9, 3.595686811064521*^9, 
   3.595740688198072*^9, 3.595741220420179*^9, 3.595742212529861*^9, {
   3.5957422762546043`*^9, 3.5957422932852983`*^9}, 3.595742464509831*^9, 
   3.595742583418107*^9, 3.5957427892338676`*^9, 3.595743106011642*^9, 
   3.595743925075*^9, 3.595744613833954*^9, 3.595744672061605*^9, 
   3.595745161749525*^9, {3.5957451983527946`*^9, 3.59574520982406*^9}, 
   3.595746215349176*^9, 3.5957462579852457`*^9, 3.595746921244102*^9, 
   3.595749007947014*^9, 3.5957504810762587`*^9, 3.595750643485033*^9, 
   3.595756010401155*^9, 3.59575630843364*^9, 3.595756461477935*^9, 
   3.595757038890984*^9, 3.595757282790587*^9, 3.595757874064645*^9, 
   3.595758895817012*^9, 3.595759181827841*^9, 3.5957606159601192`*^9, 
   3.595760851582591*^9, 3.595761013291684*^9, 3.595761151543743*^9, {
   3.5957615202850933`*^9, 3.595761537513227*^9}, 3.59576158309387*^9, 
   3.595761709652832*^9, 3.595761985592103*^9, 3.595763059691595*^9, 
   3.595930564055498*^9, 3.5959305989905243`*^9, 3.59593070502704*^9, {
   3.59593073552794*^9, 3.595930790866128*^9}, 3.5959308514635143`*^9, {
   3.595930890997754*^9, 3.595930920003017*^9}, {3.5959310575761557`*^9, 
   3.595931097258219*^9}, 3.599808229468628*^9, {3.59980843030221*^9, 
   3.599808453680998*^9}, 3.599808569382399*^9, {3.599810311576768*^9, 
   3.599810332694878*^9}, 3.599821304375375*^9, 3.599822279236309*^9, 
   3.5998226171514797`*^9, 3.599822649500223*^9, 3.599822729769024*^9, {
   3.599823098508292*^9, 3.59982312027321*^9}, 3.59982324139987*^9, 
   3.599823452540531*^9, 3.599824140492202*^9, 3.599824879225613*^9, 
   3.599825100592518*^9, 3.59983267094868*^9, 3.599832922398109*^9, 
   3.599919026717729*^9, 3.599919529930153*^9, 3.599921857470295*^9, 
   3.6004256621025543`*^9, 3.601019019899876*^9, 3.601461883676888*^9, 
   3.602827265373945*^9, 3.6028442806936493`*^9, 3.60345667564286*^9, 
   3.603461878823785*^9, 3.603518419753044*^9, 3.603540378134856*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Build", " ", "system", " ", "of", " ", "linear", " ", "equations", " ", 
   "for", " ", "fitting", " ", "and", " ", "boundary", " ", "conditions"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.601799975982575*^9, 3.601800003454625*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lgs1", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"rhodash", "[", "rs", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         "0"}], "}"}]}], "}"}], ",", "2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lgs2", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"rhodash", "[", "a", "]"}], ",", " ", 
     RowBox[{"-", 
      RowBox[{"invs", ".", "bcu", ".", "s", ".", 
       RowBox[{"rhodash", "[", "a", "]"}]}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
     "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lgs3", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"rhodash", "'"}], "[", "a", "]"}], ",", 
     RowBox[{"-", 
      RowBox[{
       RowBox[{"rhodash", "'"}], "[", "a", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
     "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lgs4", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"invs", ".", "bcu", ".", "s", ".", 
      RowBox[{"rhodash", "[", "b", "]"}]}], ",", 
     RowBox[{"-", 
      RowBox[{"rhodash", "[", "b", "]"}]}], ",", "2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lgs5", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"rhodash", "'"}], "[", "b", "]"}], ",", 
     RowBox[{"-", 
      RowBox[{
       RowBox[{"rhodash", "'"}], "[", "b", "]"}]}], ",", "2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lgs6", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
         "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "Infinity"}], "}"}]}], "}"}], 
     ",", "2"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5956815918243027`*^9, 3.595681593884449*^9}, {
   3.595681666271947*^9, 3.595681695505452*^9}, 3.595681742306477*^9, {
   3.5956817766436367`*^9, 3.595681781168887*^9}, {3.595681998634067*^9, 
   3.595682050843712*^9}, {3.595682128117206*^9, 3.595682138533176*^9}, {
   3.59568277840983*^9, 3.59568278545091*^9}, {3.595683796827847*^9, 
   3.5956838102570477`*^9}, {3.595683879261598*^9, 3.5956838940921383`*^9}, {
   3.595684020830997*^9, 3.595684072139052*^9}, {3.595684131277678*^9, 
   3.595684331857284*^9}, {3.595685413752226*^9, 3.595685414775579*^9}, {
   3.595685485642757*^9, 3.595685495243578*^9}, {3.5956855725282717`*^9, 
   3.595685592343602*^9}, {3.5956857621523247`*^9, 3.5956857634810762`*^9}, {
   3.595686555598997*^9, 3.595686558104673*^9}, {3.5957425296308737`*^9, 
   3.595742570318759*^9}, {3.595743679404758*^9, 3.5957437062176733`*^9}, {
   3.595748850138558*^9, 3.595748882874744*^9}, {3.595756260105237*^9, 
   3.595756297929058*^9}, {3.5957584710716047`*^9, 3.595758493168706*^9}, {
   3.595758880042501*^9, 3.5957588887954407`*^9}, 3.5957610036981*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"lgs", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
    "lgs1", ",", " ", "lgs2", ",", " ", "lgs3", ",", " ", "lgs4", ",", "lgs5",
      ",", "lgs6", ",", "1"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.595684336047688*^9, 3.5956843889225473`*^9}, {
   3.5956864604201813`*^9, 3.595686461774974*^9}, 3.5998084707651176`*^9, {
   3.59983192005295*^9, 3.599831921539866*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"lgs", " ", "=", " ", 
   RowBox[{"lgs", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", ";;", "11"}], ",", 
      RowBox[{"1", ";;", "11"}]}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.59568646442454*^9, 3.595686493651452*^9}, {
   3.595686525228342*^9, 3.595686533695484*^9}, {3.5956866805587053`*^9, 
   3.595686681854765*^9}, 3.595742131584399*^9, 3.595756006270975*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Calculation", " ", "of", " ", "matching", " ", "constants"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.5998336088699913`*^9, 3.599833612701809*^9}, {
  3.59983365348573*^9, 3.599833658589802*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"c", " ", "=", 
   RowBox[{"Assuming", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"g", ">", "0"}], ",", 
       RowBox[{"d", ">", "0"}], ",", 
       RowBox[{"kt", ">", "0"}], ",", 
       RowBox[{"b", ">", "a", ">", "rs", ">", "0"}]}], "}"}], ",", " ", 
     RowBox[{"LinearSolve", "[", 
      RowBox[{"lgs", ",", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", "0", ",", "0", ",", "1"}], "}"}], "}"}], "]"}]}], 
      "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.59568527902943*^9, 3.5956852836907873`*^9}, {
   3.595685332264737*^9, 3.595685366960881*^9}, {3.595685435160873*^9, 
   3.5956854363790903`*^9}, {3.595685680127013*^9, 3.595685725682897*^9}, {
   3.595685768131143*^9, 3.5956857770242167`*^9}, {3.595685820170539*^9, 
   3.595685843955449*^9}, {3.595685902637343*^9, 3.595685908912978*^9}, {
   3.595686601777063*^9, 3.5956866122814283`*^9}, 3.595686807621709*^9, {
   3.5957406782380257`*^9, 3.5957406793264236`*^9}, 3.595742141986177*^9, {
   3.595742267893507*^9, 3.595742271077671*^9}, 3.595742779392436*^9, {
   3.59574309517627*^9, 3.59574309903164*^9}, 3.595745192363536*^9, {
   3.5998082051300497`*^9, 3.599808209417911*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"c", " ", "=", " ", 
   RowBox[{"Assuming", "[", 
    RowBox[{
     RowBox[{
     "b", " ", ">", " ", "a", " ", ">", " ", "rs", " ", ">", " ", "0"}], ",", 
     
     RowBox[{"Simplify", "[", "c", "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.595741709609643*^9, 3.595741745430442*^9}, {
   3.595742800737207*^9, 3.5957428014249773`*^9}, 3.595745183833992*^9, {
   3.599808942132814*^9, 3.599808958821162*^9}, {3.5998101599911613`*^9, 
   3.599810171046412*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"c", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{"c", ",", 
     RowBox[{"{", 
      RowBox[{"{", "0", "}"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.595760824814782*^9, 3.595760825817029*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Check", ",", " ", 
   RowBox[{"if", " ", "matching", " ", "worked", " ", "out"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.599833666473074*^9, 3.599833677950109*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Simplify", "[", 
   RowBox[{"lgs", ".", 
    RowBox[{"c", "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "11"}], "]"}], "]"}]}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{
  3.595757898446609*^9, {3.595758123716482*^9, 3.5957581984535513`*^9}, {
   3.602844321503682*^9, 3.602844323871812*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rhodash1", "[", "r_", "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{"rhodash", "[", "r", "]"}], ".", 
    RowBox[{"c", "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "4"}], "]"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5957586214659243`*^9, 3.595758631792355*^9}, {
  3.595758762659315*^9, 3.595758808852933*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Simplify", "[", 
   RowBox[{"rhodash1", "[", "rs", "]"}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.59575878583849*^9, 3.5957588017799263`*^9}, {
  3.602844334640171*^9, 3.602844337696486*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rhodash2", "[", "r_", "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{"rhodash", "[", "r", "]"}], ".", 
    RowBox[{"c", "[", 
     RowBox[{"[", 
      RowBox[{"5", ";;", "8"}], "]"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.595758818257868*^9, 3.595758852823007*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rhodash3", "[", "r_", "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{"rhodash", "[", "r", "]"}], ".", 
    RowBox[{"c", "[", 
     RowBox[{"[", 
      RowBox[{"9", ";;", "12"}], "]"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.595758946957831*^9, 3.595759033835046*^9}, 
   3.595759456165715*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"invs", ".", "bcu", ".", "s", ".", 
      RowBox[{"rhodash2", "[", "b", "]"}]}], " ", "-", " ", 
     RowBox[{"rhodash3", "[", "b", "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"rhodash2", "'"}], "[", "b", "]"}], " ", "-", " ", 
     RowBox[{
      RowBox[{"rhodash3", "'"}], "[", "b", "]"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{"rhodash3", "[", "Infinity", "]"}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.595759037039929*^9, 3.595759108892818*^9}, {
  3.602844328433305*^9, 3.6028443309288883`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Calculatio", " ", "normalization", " ", "of", " ", "density", " ", 
   "profiles"}], "*)"}]], "Input",
 CellChangeTimes->{{3.599833749385008*^9, 3.599833764879436*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"n", " ", "=", " ", 
  RowBox[{"Limit", "[", 
   RowBox[{
    RowBox[{"Total", "[", 
     RowBox[{"Total", "[", 
      RowBox[{"s", ".", 
       RowBox[{"rhodash3", "[", "r", "]"}]}], "]"}], "]"}], ",", 
    RowBox[{"r", "\[Rule]", "Infinity"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.599824394831564*^9, 3.59982442690827*^9}, {
  3.5998244661155024`*^9, 3.5998244710908127`*^9}}],

Cell[BoxData[
 SqrtBox["2"]], "Output",
 CellChangeTimes->{{3.5998244544007883`*^9, 3.5998244714891233`*^9}, 
   3.5998249522793293`*^9, 3.599825130273117*^9, 3.599832700807884*^9, 
   3.599832952403077*^9, 3.599919055313205*^9, 3.599919558500083*^9, 
   3.599921886212059*^9, 3.600425699576535*^9, 3.6010190569680023`*^9, 
   3.601461991880183*^9, 3.602827316122944*^9, 3.602844309787631*^9, 
   3.603456688542692*^9, 3.60346189203824*^9, 3.603518432849639*^9, 
   3.60354039104103*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Calculate", " ", "density", " ", "profiles"}], "*)"}]], "Input",
 CellChangeTimes->{{3.599833768313113*^9, 3.599833782896035*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"rho1", "[", "r_", "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{"s", ".", 
     RowBox[{"rhodash1", "[", "r", "]"}]}], "/", "n"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rho2", "[", "r_", "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{"s", ".", 
     RowBox[{"rhodash2", "[", "r", "]"}]}], "/", "n"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rho3", "[", "r_", "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{"s", ".", 
     RowBox[{"rhodash3", "[", "r", "]"}]}], "/", "n"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.59575907745347*^9, 3.595759077979726*^9}, {
  3.5957591179960327`*^9, 3.595759161020796*^9}, {3.595759463286222*^9, 
  3.5957594645180693`*^9}, {3.5998243392805853`*^9, 3.599824345920013*^9}, {
  3.5998244336177673`*^9, 3.599824437826151*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"rhom1", "[", "r_", "]"}], " ", "=", 
   RowBox[{
    RowBox[{"Part", "[", 
     RowBox[{
      RowBox[{"rho1", "[", "r", "]"}], ",", "1"}], "]"}], "+", " ", 
    RowBox[{"Part", "[", 
     RowBox[{
      RowBox[{"rho1", "[", "r", "]"}], ",", "2"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rhom2", "[", "r_", "]"}], " ", "=", 
   RowBox[{
    RowBox[{"Part", "[", 
     RowBox[{
      RowBox[{"rho2", "[", "r", "]"}], ",", "1"}], "]"}], "+", " ", 
    RowBox[{"Part", "[", 
     RowBox[{
      RowBox[{"rho2", "[", "r", "]"}], ",", "2"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rhom3", "[", "r_", "]"}], " ", "=", 
   RowBox[{
    RowBox[{"Part", "[", 
     RowBox[{
      RowBox[{"rho3", "[", "r", "]"}], ",", "1"}], "]"}], "+", " ", 
    RowBox[{"Part", "[", 
     RowBox[{
      RowBox[{"rho3", "[", "r", "]"}], ",", "2"}], "]"}]}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.595761380180642*^9, 3.595761381685871*^9}, {
  3.599824443250636*^9, 3.5998244520340233`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.599824364727008*^9, 3.5998243901917963`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Calculate", " ", "absorption", " ", "rate", " ", 
   RowBox[{"(", 
    RowBox[{"omit", " ", "the", " ", "4", " ", "pi", " ", "D", " ", "Rs"}], 
    ")"}], " ", "such", " ", "that", " ", "the", " ", "result", " ", "is", 
   " ", "normalized", " ", "to", " ", "the", " ", "debye", " ", "result", " ",
    "for", " ", "the", " ", "ungated", " ", "problem"}], "*)"}]], "Input",
 CellChangeTimes->{{3.5998337875698853`*^9, 3.599833828368689*^9}, {
  3.601800030595181*^9, 3.601800052317612*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rho1dash", "[", "r_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"rhom1", "'"}], "[", "r", "]"}]}]], "Input",
 CellChangeTimes->{{3.5998103797433*^9, 3.599810404986494*^9}, 
   3.5998109326407824`*^9}],

Cell[BoxData[
 RowBox[{"k", ":=", "  ", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Total", "[", 
    RowBox[{"rho1dash", "[", "1", "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.599810418479719*^9, 3.599810431930291*^9}, {
   3.5998104896748466`*^9, 3.5998104988265667`*^9}, {3.599810670621051*^9, 
   3.599810722383141*^9}, {3.599810759389567*^9, 3.599810762831608*^9}, 
   3.5998107973441677`*^9, {3.599810847680478*^9, 3.599810857685964*^9}, {
   3.5998115034826717`*^9, 3.599811503900137*^9}, {3.599812223813181*^9, 
   3.599812225621484*^9}, {3.599812303783699*^9, 3.599812304933983*^9}, {
   3.5998123450480022`*^9, 3.599812347047414*^9}, {3.599832634179991*^9, 
   3.59983266022283*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Make", " ", "absorption", " ", "rate", " ", "a", " ", "function", " ", 
   "of", " ", "its", " ", "parameters"}], "*)"}]], "Input",
 CellChangeTimes->{{3.599833834368971*^9, 3.599833848929592*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fk", "[", 
   RowBox[{"a_", ",", "b_", ",", "u_", ",", "x_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"u", "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "b"}], ")"}], " ", "x"}]}]], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"a", " ", "x"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"b", " ", "x"}]}], ")"}]}], "-", 
     RowBox[{"2", " ", "b", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", "+", "a", "+", "b"}], ")"}], " ", "x"}]], " ", "x", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"b", " ", "x"}]}], ")"}]}], "+", 
     RowBox[{"2", " ", "b", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", "a"}], "+", "b"}], ")"}], " ", "x"}]], " ", "x", 
      " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"b", " ", "x"}]}], ")"}]}], "-", 
     RowBox[{"4", " ", "b", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"u", "+", 
        RowBox[{"3", " ", "a", " ", "x"}], "+", 
        RowBox[{"b", " ", "x"}]}]], " ", "x", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"b", " ", "x"}]}], ")"}]}], "+", 
     RowBox[{"2", " ", "b", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"2", " ", "u"}], "+", 
        RowBox[{"3", " ", "a", " ", "x"}], "+", 
        RowBox[{"b", " ", "x"}]}]], " ", "x", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"b", " ", "x"}]}], ")"}]}], "+", 
     RowBox[{"4", " ", "b", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"u", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "+", "a", "+", "b"}], ")"}], " ", "x"}]}]], " ", "x", 
      " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"b", " ", "x"}]}], ")"}]}], "-", 
     RowBox[{"2", " ", "b", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"2", " ", "u"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "+", "a", "+", "b"}], ")"}], " ", "x"}]}]], " ", "x", 
      " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"b", " ", "x"}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"4", " ", "a", " ", "x"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"a", " ", "x"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"b", " ", "x"}]}], ")"}]}], "-", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "a"}], ")"}], " ", "x"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"a", " ", "x"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"b", " ", "x"}]}], ")"}]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"u", "+", 
        RowBox[{"4", " ", "a", " ", "x"}]}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"a", " ", "x"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"b", " ", "x"}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"2", " ", "u"}], "+", 
        RowBox[{"4", " ", "a", " ", "x"}]}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"a", " ", "x"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"b", " ", "x"}]}], ")"}]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"u", "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "a"}], ")"}], " ", "x"}]}]], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"a", " ", "x"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"b", " ", "x"}]}], ")"}]}], "-", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"u", "+", "x", "+", 
          RowBox[{"b", " ", "x"}]}], ")"}]}]], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"a", " ", "x"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"b", " ", "x"}]}], ")"}]}], "-", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"u", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"a", "+", "b"}], ")"}], " ", "x"}]}], ")"}]}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"3", " ", "a", " ", "x"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"b", " ", "x"}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"u", "+", "x", "+", 
          RowBox[{"a", " ", "x"}]}], ")"}]}]], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"3", " ", "a", " ", "x"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"b", " ", "x"}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "b"}], ")"}], " ", "x"}]], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"a", " ", "x"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"3", " ", "b", " ", "x"}]}], ")"}]}], "-", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"a", "+", "b"}], ")"}], " ", "x"}]], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"a", " ", "x"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"3", " ", "b", " ", "x"}]}], ")"}]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"u", "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"a", "+", "b"}], ")"}], " ", "x"}]}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"b", " ", "x"}], "+", 
        RowBox[{"a", " ", 
         RowBox[{"(", 
          RowBox[{"x", "-", 
           RowBox[{"5", " ", "b", " ", 
            SuperscriptBox["x", "2"]}]}], ")"}]}]}], ")"}]}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"u", "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "b"}], ")"}], " ", "x"}]}]], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"a", " ", "x"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "b"}], ")"}], " ", "x"}]}], ")"}]}], "+", 
     
     RowBox[{"2", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", "+", "a", "+", "b"}], ")"}], " ", "x"}]], " ", "x", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "a", "-", 
        RowBox[{"a", " ", "x"}], "+", 
        RowBox[{
         SuperscriptBox["a", "2"], " ", "x"}], "-", 
        RowBox[{"b", " ", "x"}]}], ")"}]}], "-", 
     RowBox[{"4", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"u", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "+", "a", "+", "b"}], ")"}], " ", "x"}]}]], " ", "x", 
      " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "a", "-", 
        RowBox[{"a", " ", "x"}], "+", 
        RowBox[{
         SuperscriptBox["a", "2"], " ", "x"}], "-", 
        RowBox[{"b", " ", "x"}]}], ")"}]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"2", " ", "u"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "+", "a", "+", "b"}], ")"}], " ", "x"}]}]], " ", "x", 
      " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "a", "-", 
        RowBox[{"a", " ", "x"}], "+", 
        RowBox[{
         SuperscriptBox["a", "2"], " ", "x"}], "-", 
        RowBox[{"b", " ", "x"}]}], ")"}]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"u", "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "a"}], ")"}], " ", "x"}]}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "a"}], ")"}], " ", "x"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"b", " ", "x"}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"4", " ", "a", " ", "x"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"a", " ", "x"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"b", " ", "x"}]}], ")"}]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"u", "+", 
        RowBox[{"4", " ", "a", " ", "x"}]}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"a", " ", "x"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"b", " ", "x"}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"2", " ", "u"}], "+", 
        RowBox[{"4", " ", "a", " ", "x"}]}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"a", " ", "x"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"b", " ", "x"}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"u", "+", "x", "+", 
          RowBox[{"a", " ", "x"}]}], ")"}]}]], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "+", "a"}], ")"}], " ", "x"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"b", " ", "x"}]}], ")"}]}], "-", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "a"}], ")"}], " ", "x"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", 
           RowBox[{"3", " ", "a"}]}], ")"}], " ", "x"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"b", " ", "x"}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "b"}], ")"}], " ", "x"}]], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"a", " ", "x"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "+", "b"}], ")"}], " ", "x"}]}], ")"}]}], "-", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"u", "+", "x", "+", 
          RowBox[{"b", " ", "x"}]}], ")"}]}]], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"a", " ", "x"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", 
           RowBox[{"3", " ", "b"}]}], ")"}], " ", "x"}]}], ")"}]}], "-", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"u", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"a", "+", "b"}], ")"}], " ", "x"}]}], ")"}]}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"4", "+", "a", "-", 
           RowBox[{"3", " ", "b"}]}], ")"}], " ", "x"}], "+", 
        RowBox[{"3", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "b"}], ")"}]}], "+", 
           RowBox[{"2", " ", "b"}]}], ")"}], " ", 
         SuperscriptBox["x", "2"]}]}], ")"}]}], "-", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"a", "+", "b"}], ")"}], " ", "x"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"4", "-", 
           RowBox[{"3", " ", "a"}], "+", "b"}], ")"}], " ", "x"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "b"}], "+", 
           RowBox[{"a", " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"3", " ", "b"}]}], ")"}]}]}], ")"}], " ", 
         SuperscriptBox["x", "2"]}]}], ")"}]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"u", "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"a", "+", "b"}], ")"}], " ", "x"}]}]], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "4"}], "+", "a", "+", "b"}], ")"}], " ", "x"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "b"}], "+", 
           RowBox[{"a", " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"5", " ", "b"}]}], ")"}]}]}], ")"}], " ", 
         SuperscriptBox["x", "2"]}]}], ")"}]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", "a"}], "+", "b"}], ")"}], " ", "x"}]], " ", "x", 
      " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", 
        RowBox[{
         SuperscriptBox["a", "2"], " ", "x"}], "+", 
        RowBox[{"b", " ", "x"}], "-", 
        RowBox[{"a", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "x"}], ")"}]}]}], ")"}]}], "-", 
     RowBox[{"4", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"u", "+", 
        RowBox[{"3", " ", "a", " ", "x"}], "+", 
        RowBox[{"b", " ", "x"}]}]], " ", "x", " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", 
        RowBox[{
         SuperscriptBox["a", "2"], " ", "x"}], "+", 
        RowBox[{"b", " ", "x"}], "-", 
        RowBox[{"a", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "x"}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"2", " ", "u"}], "+", 
        RowBox[{"3", " ", "a", " ", "x"}], "+", 
        RowBox[{"b", " ", "x"}]}]], " ", "x", " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", 
        RowBox[{
         SuperscriptBox["a", "2"], " ", "x"}], "+", 
        RowBox[{"b", " ", "x"}], "-", 
        RowBox[{"a", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "x"}], ")"}]}]}], ")"}]}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.599831644489749*^9, 3.599831682827771*^9}, 
   3.599831757763814*^9, {3.600950414300556*^9, 3.600950418111516*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "Calculate", " ", "limiting", " ", "behaviour", " ", "for", " ", "x"}], 
   " ", "\[Rule]", "0"}], "*)"}]], "Input",
 CellChangeTimes->{{3.5998338578443003`*^9, 3.599833875842061*^9}, 
   3.5998343742330437`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Assuming", "[", 
  RowBox[{
   RowBox[{"b", " ", ">", " ", "a", " ", ">", " ", "1"}], ",", 
   RowBox[{"Limit", "[", 
    RowBox[{"k", ",", 
     RowBox[{"x", "\[Rule]", "0"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.599814102033372*^9, 3.599814102209371*^9}, {
   3.599814315729422*^9, 3.599814349877935*^9}, 3.599822607701098*^9, {
   3.599823219861783*^9, 3.59982322556754*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"b", "-", 
   RowBox[{"b", " ", 
    SuperscriptBox["\[ExponentialE]", "u"]}], "+", 
   RowBox[{"a", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      RowBox[{"2", " ", "b"}], "+", 
      SuperscriptBox["\[ExponentialE]", "u"]}], ")"}]}]}], 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{"b", "-", 
     RowBox[{"b", " ", 
      SuperscriptBox["\[ExponentialE]", "u"]}], "+", 
     RowBox[{"a", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "-", "b", "+", 
        SuperscriptBox["\[ExponentialE]", "u"]}], ")"}]}]}], 
    ")"}]}]]], "Output",
 CellChangeTimes->{3.601019081726091*^9, 3.601462068691334*^9, 
  3.602827320725272*^9, 3.602844312501663*^9, 3.603456691758853*^9, 
  3.6034618954128323`*^9, 3.603518437628924*^9, 3.603540394221339*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"klim0", "[", 
   RowBox[{"a_", ",", "b_", ",", "u_"}], "]"}], ":=", 
  FractionBox[
   RowBox[{"b", "-", 
    RowBox[{"b", " ", 
     SuperscriptBox["\[ExponentialE]", "u"]}], "+", 
    RowBox[{"a", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "-", 
       RowBox[{"2", " ", "b"}], "+", 
       SuperscriptBox["\[ExponentialE]", "u"]}], ")"}]}]}], 
   RowBox[{" ", 
    RowBox[{"2", 
     RowBox[{"(", 
      RowBox[{"b", "-", 
       RowBox[{"b", " ", 
        SuperscriptBox["\[ExponentialE]", "u"]}], "+", 
       RowBox[{"a", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "-", "b", "+", 
          SuperscriptBox["\[ExponentialE]", "u"]}], ")"}]}]}], 
      ")"}]}]}]]}]], "Input",
 CellChangeTimes->{{3.599821510581478*^9, 3.5998215253338013`*^9}, 
   3.5998217016898727`*^9, 3.599821757467021*^9, {3.599821792666464*^9, 
   3.59982180980293*^9}, {3.599823274800201*^9, 3.5998232786058397`*^9}, {
   3.599823317553458*^9, 3.599823331392984*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
    "Calculate", " ", "limiting", " ", "behaviour", " ", "for", " ", "x"}], 
    " ", "\[Rule]", " ", 
    RowBox[{"oo", " ", "by", " ", "hand"}]}], ",", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "since", " ", "mathematica", " ", "resists", " ", "do", " ", "it"}], 
     "..."}], " ", "terefore", " ", "only", " ", "collect", " ", "terms", " ",
     "with", " ", "leading", " ", "exponents", " ", "from", " ", "k", " ", 
    "and", " ", "simplify", " ", "the", " ", "resulting", " ", "rational", 
    " ", "function"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.5998338830227203`*^9, 3.599833921618846*^9}, 
   3.5998343766496477`*^9, {3.601800133760387*^9, 3.60180014649685*^9}, {
   3.601801204600834*^9, 3.60180123190705*^9}, {3.601801276533967*^9, 
   3.601801289141464*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"u", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"a", "+", "b"}], ")"}], " ", "x"}]}], ")"}]}]]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"3", " ", "a", " ", "x"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"b", " ", "x"}]}], ")"}]}], "-", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"a", "+", "b"}], ")"}], " ", "x"}]], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"a", " ", "x"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"3", " ", "b", " ", "x"}]}], ")"}]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"u", "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"a", "+", "b"}], ")"}], " ", "x"}]}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"b", " ", "x"}], "+", 
        RowBox[{"a", " ", 
         RowBox[{"(", 
          RowBox[{"x", "-", 
           RowBox[{"5", " ", "b", " ", 
            SuperscriptBox["x", "2"]}]}], ")"}]}]}], ")"}]}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"u", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"a", "+", "b"}], ")"}], " ", "x"}]}], ")"}]}]]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"4", "+", "a", "-", 
           RowBox[{"3", " ", "b"}]}], ")"}], " ", "x"}], "+", 
        RowBox[{"3", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "b"}], ")"}]}], "+", 
           RowBox[{"2", " ", "b"}]}], ")"}], " ", 
         SuperscriptBox["x", "2"]}]}], ")"}]}], "-", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"a", "+", "b"}], ")"}], " ", "x"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"4", "-", 
           RowBox[{"3", " ", "a"}], "+", "b"}], ")"}], " ", "x"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "b"}], "+", 
           RowBox[{"a", " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"3", " ", "b"}]}], ")"}]}]}], ")"}], " ", 
         SuperscriptBox["x", "2"]}]}], ")"}]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"u", "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"a", "+", "b"}], ")"}], " ", "x"}]}]], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "4"}], "+", "a", "+", "b"}], ")"}], " ", "x"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "b"}], "+", 
           RowBox[{"a", " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"5", " ", "b"}]}], ")"}]}]}], ")"}], " ", 
         SuperscriptBox["x", "2"]}]}], ")"}]}]}], ")"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.599828740292829*^9, 3.599828944330968*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"a", " ", "x"}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", "u"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"3", " ", "a", " ", "x"}]}], ")"}]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"3", " ", "b", " ", "x"}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", "u"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"b", " ", "x"}]}], ")"}]}]}], ")"}]}], 
  RowBox[{
   RowBox[{"-", "1"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"4", "-", 
      RowBox[{"3", " ", "a"}], "+", "b"}], ")"}], " ", "x"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "a"}], "-", 
      RowBox[{"2", " ", "b"}], "+", 
      RowBox[{"3", " ", "a", " ", "b"}]}], ")"}], " ", 
    SuperscriptBox["x", "2"]}], "+", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"2", " ", "u"}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"4", "+", "a", "-", 
         RowBox[{"3", " ", "b"}]}], ")"}], " ", "x"}], "+", 
      RowBox[{"3", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "b"}], ")"}]}], "+", 
         RowBox[{"2", " ", "b"}]}], ")"}], " ", 
       SuperscriptBox["x", "2"]}]}], ")"}]}], "+", 
   RowBox[{"2", " ", 
    SuperscriptBox["\[ExponentialE]", "u"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "4"}], "+", "a", "+", "b"}], ")"}], " ", "x"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "a"}], "-", 
         RowBox[{"2", " ", "b"}], "+", 
         RowBox[{"5", " ", "a", " ", "b"}]}], ")"}], " ", 
       SuperscriptBox["x", "2"]}]}], ")"}]}]}]]], "Output",
 CellChangeTimes->{
  3.599828944886039*^9, {3.5998292359722633`*^9, 3.599829264663797*^9}, 
   3.59983274032502*^9, 3.5998329915116796`*^9, 3.5999190738559113`*^9, 
   3.5999195770679417`*^9, 3.599921904593021*^9, 3.600425724428149*^9, 
   3.601019081901595*^9, 3.601462069115841*^9, 3.6028273208950157`*^9, 
   3.6028443126336*^9, 3.603456691927375*^9, 3.603461895589129*^9, 
   3.603518437842207*^9, 3.603540394376013*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Then", " ", "take", " ", "the", " ", "limit", " ", "for", " ", "x", " ", 
   "to", " ", "infinity"}], "*)"}]], "Input",
 CellChangeTimes->{{3.601801312939892*^9, 3.601801331552522*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Limit", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"a", " ", "x"}], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", "u"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"3", " ", "a", " ", "x"}]}], ")"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"3", " ", "b", " ", "x"}], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", "u"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"b", " ", "x"}]}], ")"}]}]}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"4", "-", 
         RowBox[{"3", " ", "a"}], "+", "b"}], ")"}], " ", "x"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "a"}], "-", 
         RowBox[{"2", " ", "b"}], "+", 
         RowBox[{"3", " ", "a", " ", "b"}]}], ")"}], " ", 
       SuperscriptBox["x", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "u"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"4", "+", "a", "-", 
            RowBox[{"3", " ", "b"}]}], ")"}], " ", "x"}], "+", 
         RowBox[{"3", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "b"}], ")"}]}], "+", 
            RowBox[{"2", " ", "b"}]}], ")"}], " ", 
          SuperscriptBox["x", "2"]}]}], ")"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", "u"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "4"}], "+", "a", "+", "b"}], ")"}], " ", "x"}], "+", 
         
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "a"}], "-", 
            RowBox[{"2", " ", "b"}], "+", 
            RowBox[{"5", " ", "a", " ", "b"}]}], ")"}], " ", 
          SuperscriptBox["x", "2"]}]}], ")"}]}]}], ")"}]}], ",", 
   RowBox[{"x", "\[Rule]", "Infinity"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.599828963064234*^9, 3.599828973524981*^9}, {
  3.5998292684919024`*^9, 3.599829272394758*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"a", " ", "b", " ", 
   RowBox[{"(", 
    RowBox[{"3", "+", 
     SuperscriptBox["\[ExponentialE]", "u"]}], ")"}]}], 
  RowBox[{
   RowBox[{"2", " ", "b", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["\[ExponentialE]", "u"]}], ")"}]}], "+", 
   RowBox[{"a", " ", 
    RowBox[{"(", 
     RowBox[{"2", "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", "u"]}], "+", 
      RowBox[{"b", " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", 
         SuperscriptBox["\[ExponentialE]", "u"]}], ")"}]}]}], 
     ")"}]}]}]]], "Output",
 CellChangeTimes->{3.599828974709256*^9, 3.59982924103538*^9, 
  3.599829274484748*^9, 3.5998327404939413`*^9, 3.5998329916563187`*^9, 
  3.599919073996475*^9, 3.5999195771986713`*^9, 3.599921904711228*^9, 
  3.600425724623611*^9, 3.601019082091498*^9, 3.60146206954392*^9, 
  3.602827321094137*^9, 3.602844312767193*^9, 3.603456692115171*^9, 
  3.603461895779673*^9, 3.603518438014317*^9, 3.603540394547048*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"kliminf", "[", 
   RowBox[{"a_", ",", "b_", ",", "u_"}], "]"}], ":=", 
  FractionBox[
   RowBox[{"a", " ", "b", " ", 
    RowBox[{"(", 
     RowBox[{"3", "+", 
      SuperscriptBox["\[ExponentialE]", "u"]}], ")"}]}], 
   RowBox[{
    RowBox[{"2", " ", "b", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["\[ExponentialE]", "u"]}], ")"}]}], "+", 
    RowBox[{"a", " ", 
     RowBox[{"(", 
      RowBox[{"2", "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["\[ExponentialE]", "u"]}], "+", 
       RowBox[{"b", " ", 
        RowBox[{"(", 
         RowBox[{"3", "+", 
          SuperscriptBox["\[ExponentialE]", "u"]}], ")"}]}]}], 
      ")"}]}]}]]}]], "Input",
 CellChangeTimes->{{3.5998315592607307`*^9, 3.599831584337322*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Do", " ", "some", " ", "plot", " ", "of", " ", "the", " ", "results"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.5998339274703417`*^9, 3.599833940402157*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"kliminfdebye", "[", 
   RowBox[{"a_", ",", "b_", ",", "u_"}], "]"}], ":=", 
  RowBox[{"a", "*", 
   RowBox[{"b", "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", "*", "b"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"b", "-", "a"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Exp", "[", 
          RowBox[{"u", "/", "2"}], "]"}]}], ")"}]}]}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6035401292557898`*^9, 3.60354016041448*^9}, {
  3.603540266932968*^9, 3.6035403323888474`*^9}, {3.6035406370533123`*^9, 
  3.603540637300284*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"a", "=", "200"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FindMaximum", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fk", "[", 
      RowBox[{"a", ",", "b", ",", "u", ",", "x"}], "]"}], ",", 
     RowBox[{"x", ">", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"1", "/", 
      RowBox[{"a", "^", "2"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"b", ",", 
     RowBox[{"100", " ", "*", "a"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.603465072553872*^9, 3.6034651268142347`*^9}, {
   3.603465478419938*^9, 3.603465530105996*^9}, 3.603465787431498*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"8.244411841488299`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "\[Rule]", "0.00004149944868416569`"}], ",", 
     RowBox[{"b", "\[Rule]", "166644.2381347735`"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.599831531012102*^9, {3.5998318254401293`*^9, 3.599831860466977*^9}, 
   3.5998327408964443`*^9, 3.599832775842058*^9, 3.599832992016047*^9, {
   3.599833041459469*^9, 3.599833085526032*^9}, 3.5998331160500174`*^9, {
   3.599833150695801*^9, 3.599833264802346*^9}, 3.599919074301167*^9, 
   3.599919577424041*^9, 3.599921904955552*^9, {3.599923060940464*^9, 
   3.599923208586323*^9}, 3.600425724701165*^9, {3.600953550810339*^9, 
   3.600953600737727*^9}, 3.600953638232332*^9, {3.600953679378723*^9, 
   3.600953742106168*^9}, 3.601019082158361*^9, 3.601462069681586*^9, {
   3.601801367683576*^9, 3.60180141194942*^9}, 3.601808440998736*^9, 
   3.602827322345372*^9, 3.602827433102655*^9, 3.6028276383769503`*^9, 
   3.6028443129246492`*^9, 3.603456692644943*^9, {3.603461834179215*^9, 
   3.6034618960477324`*^9}, 3.603461937406824*^9, {3.603461993524356*^9, 
   3.60346209186899*^9}, {3.603463292919797*^9, 3.6034633463850718`*^9}, {
   3.60346409381688*^9, 3.603464397206943*^9}, {3.603464440758573*^9, 
   3.603464533790186*^9}, 3.6034646497841063`*^9, {3.6034650736252623`*^9, 
   3.603465100455598*^9}, 3.6034651329126797`*^9, {3.6034653080767*^9, 
   3.603465315578846*^9}, 3.6034654818992567`*^9, {3.603465514979982*^9, 
   3.6034655318699512`*^9}, 3.603465787846621*^9, 3.603518440955555*^9, 
   3.6035403950141478`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
    "Limiting", " ", "behaviour", " ", "is", " ", "somewhat", " ", 
     "different", " ", "from", " ", "what", " ", "we", " ", "expected", " ", 
     "and", " ", "not", " ", "very", " ", "intuitive", " ", "to", " ", 
     "understand", " ", "at", " ", "first", " ", "glance"}], "..."}], " ", 
   "BUT", " ", "this", " ", "looks", " ", "a", " ", "lot", " ", "better", " ",
    "than", " ", "everything", " ", 
   RowBox[{"i", "'"}], "ve", " ", "had", " ", "so", " ", 
   RowBox[{"far", "."}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.599833943840251*^9, 3.599834024565194*^9}, 
   3.599834382762107*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "Now", " ", "lets", " ", "have", " ", "a", " ", "look", " ", "at", " ", 
    "the", " ", "approximate", " ", "behaviour", " ", "of", " ", "k", " ", 
    "for", " ", "x"}], "\[Rule]", 
   RowBox[{
    RowBox[{"oo", " ", "and", " ", "x"}], "\[Rule]", "0."}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.59991979671245*^9, 3.599919828445827*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Therefore", " ", "for", " ", "x"}], "\[Rule]", 
   RowBox[{
   "oo", " ", "collect", " ", "the", " ", "terms", " ", "with", " ", 
    "largest", " ", "exponent", " ", "from", " ", "numerator", " ", "and", 
    " ", "denominator", " ", "of", " ", "k"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.599919833738546*^9, 3.599919872958956*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"klargex", " ", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"a", " ", "x"}], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", "u"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"3", " ", "a", " ", "x"}]}], ")"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"3", " ", "b", " ", "x"}], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", "u"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"b", " ", "x"}]}], ")"}]}]}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"4", "-", 
         RowBox[{"3", " ", "a"}], "+", "b"}], ")"}], " ", "x"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "a"}], "-", 
         RowBox[{"2", " ", "b"}], "+", 
         RowBox[{"3", " ", "a", " ", "b"}]}], ")"}], " ", 
       SuperscriptBox["x", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "u"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"4", "+", "a", "-", 
            RowBox[{"3", " ", "b"}]}], ")"}], " ", "x"}], "+", 
         RowBox[{"3", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "b"}], ")"}]}], "+", 
            RowBox[{"2", " ", "b"}]}], ")"}], " ", 
          SuperscriptBox["x", "2"]}]}], ")"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", "u"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "4"}], "+", "a", "+", "b"}], ")"}], " ", "x"}], "+", 
         
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "a"}], "-", 
            RowBox[{"2", " ", "b"}], "+", 
            RowBox[{"5", " ", "a", " ", "b"}]}], ")"}], " ", 
          SuperscriptBox["x", "2"]}]}], ")"}]}]}], ")"}]}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.599910527585024*^9, 3.5999105313770514`*^9}, {
  3.599910637891275*^9, 3.599910643442994*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"200", " ", "x"}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"600", " ", "x"}]}], ")"}]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"3", " ", "b", " ", "x"}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", "4"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"b", " ", "x"}]}], ")"}]}]}], ")"}]}], 
  RowBox[{
   RowBox[{"-", "1"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "596"}], "+", "b"}], ")"}], " ", "x"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"400", "+", 
      RowBox[{"598", " ", "b"}]}], ")"}], " ", 
    SuperscriptBox["x", "2"]}], "+", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", "8"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      RowBox[{"3", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "68"}], "+", "b"}], ")"}], " ", "x"}], "+", 
      RowBox[{"6", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "200"}], "+", 
         RowBox[{"101", " ", "b"}]}], ")"}], " ", 
       SuperscriptBox["x", "2"]}]}], ")"}]}], "+", 
   RowBox[{"2", " ", 
    SuperscriptBox["\[ExponentialE]", "4"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"196", "+", "b"}], ")"}], " ", "x"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"400", "+", 
         RowBox[{"998", " ", "b"}]}], ")"}], " ", 
       SuperscriptBox["x", "2"]}]}], ")"}]}]}]]], "Output",
 CellChangeTimes->{3.599910532972034*^9, 3.599910644160674*^9, 
  3.5999190743707647`*^9, 3.5999195775221443`*^9, 3.599921905043784*^9, 
  3.600425725050609*^9, 3.601019082531541*^9, 3.601462070827021*^9, 
  3.602827322529024*^9, 3.602844312999765*^9, 3.602869966724957*^9, 
  3.603456692753093*^9, 3.6034618961995983`*^9, 3.603518441034292*^9, 
  3.603540395093255*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"a", " ", "x"}], "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", "u"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"3", " ", "a", " ", "x"}]}], ")"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"3", " ", "b", " ", "x"}], "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", "u"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"b", " ", "x"}]}], ")"}]}]}], ")"}]}], ")"}], ",", "x"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.5999193812497177`*^9, 3.5999194048222857`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "1"}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["\[ExponentialE]", "4"]}], "-", 
  SuperscriptBox["\[ExponentialE]", "8"], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "200"}], "+", 
     RowBox[{"3", " ", "b"}], "-", 
     RowBox[{"400", " ", 
      SuperscriptBox["\[ExponentialE]", "4"]}], "-", 
     RowBox[{"2", " ", "b", " ", 
      SuperscriptBox["\[ExponentialE]", "4"]}], "+", 
     RowBox[{"600", " ", 
      SuperscriptBox["\[ExponentialE]", "8"]}], "-", 
     RowBox[{"b", " ", 
      SuperscriptBox["\[ExponentialE]", "8"]}]}], ")"}], " ", "x"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"600", " ", "b"}], "+", 
     RowBox[{"2000", " ", "b", " ", 
      SuperscriptBox["\[ExponentialE]", "4"]}], "+", 
     RowBox[{"600", " ", "b", " ", 
      SuperscriptBox["\[ExponentialE]", "8"]}]}], ")"}], " ", 
   SuperscriptBox["x", "2"]}]}]], "Output",
 CellChangeTimes->{3.5999194164739513`*^9, 3.5999195775527887`*^9, 
  3.599921905062427*^9, 3.600425725096239*^9, 3.601019082588377*^9, 
  3.601462070905953*^9, 3.602827322553999*^9, 3.602844313028957*^9, 
  3.603456692795539*^9, 3.603461896246917*^9, 3.603518441079894*^9, 
  3.6035403951326838`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"4", "-", 
        RowBox[{"3", " ", "a"}], "+", "b"}], ")"}], " ", "x"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "a"}], "-", 
        RowBox[{"2", " ", "b"}], "+", 
        RowBox[{"3", " ", "a", " ", "b"}]}], ")"}], " ", 
      SuperscriptBox["x", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "u"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"4", "+", "a", "-", 
           RowBox[{"3", " ", "b"}]}], ")"}], " ", "x"}], "+", 
        RowBox[{"3", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "b"}], ")"}]}], "+", 
           RowBox[{"2", " ", "b"}]}], ")"}], " ", 
         SuperscriptBox["x", "2"]}]}], ")"}]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["\[ExponentialE]", "u"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "4"}], "+", "a", "+", "b"}], ")"}], " ", "x"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "a"}], "-", 
           RowBox[{"2", " ", "b"}], "+", 
           RowBox[{"5", " ", "a", " ", "b"}]}], ")"}], " ", 
         SuperscriptBox["x", "2"]}]}], ")"}]}]}], ")"}], ",", "x"}], 
  "]"}]], "Input",
 CellChangeTimes->{3.599919414439537*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "1"}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["\[ExponentialE]", "4"]}], "-", 
  SuperscriptBox["\[ExponentialE]", "8"], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "596"}], "+", "b", "+", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"196", "+", "b"}], ")"}], " ", 
      SuperscriptBox["\[ExponentialE]", "4"]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"204", "-", 
        RowBox[{"3", " ", "b"}]}], ")"}], " ", 
      SuperscriptBox["\[ExponentialE]", "8"]}]}], ")"}], " ", "x"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"400", "+", 
     RowBox[{"598", " ", "b"}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"400", "+", 
        RowBox[{"998", " ", "b"}]}], ")"}], " ", 
      SuperscriptBox["\[ExponentialE]", "4"]}], "+", 
     RowBox[{"3", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"200", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "b"}], ")"}]}], "+", 
        RowBox[{"2", " ", "b"}]}], ")"}], " ", 
      SuperscriptBox["\[ExponentialE]", "8"]}]}], ")"}], " ", 
   SuperscriptBox["x", "2"]}]}]], "Output",
 CellChangeTimes->{3.599919419191567*^9, 3.599919577588089*^9, 
  3.599921905081964*^9, 3.600425725136619*^9, 3.601019082647739*^9, 
  3.601462070999204*^9, 3.602827322578204*^9, 3.602844313049406*^9, 
  3.6034566928980513`*^9, 3.60346189629812*^9, 3.603518441136731*^9, 
  3.603540395168818*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Then", ",", " ", 
   RowBox[{
   "from", " ", "each", " ", "collect", " ", "the", " ", "leading", " ", 
    "terms", " ", "in", " ", "x", " ", "and", " ", "simplify"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.599919882381722*^9, 3.5999199075511017`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fklargex", "[", 
   RowBox[{"a_", ",", "b_", ",", "u_", ",", "x_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", "u"]}], "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "u"}]], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "a"}], "+", 
         RowBox[{"3", " ", "b"}], "-", 
         RowBox[{"2", " ", "a", " ", 
          SuperscriptBox["\[ExponentialE]", "u"]}], "-", 
         RowBox[{"2", " ", "b", " ", 
          SuperscriptBox["\[ExponentialE]", "u"]}], "+", 
         RowBox[{"3", " ", "a", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"2", " ", "u"}]]}], "-", 
         RowBox[{"b", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"2", " ", "u"}]]}]}], ")"}], " ", "x"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", "a", " ", "b"}], "+", 
         RowBox[{"10", " ", "a", " ", "b", " ", 
          SuperscriptBox["\[ExponentialE]", "u"]}], "+", 
         RowBox[{"3", " ", "a", " ", "b", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"2", " ", "u"}]]}]}], ")"}], " ", 
       SuperscriptBox["x", "2"]}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", "u"]}], "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "u"}]], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"4", "-", 
         RowBox[{"3", " ", "a"}], "+", "b", "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "4"}], "+", "a", "+", "b"}], ")"}], " ", 
          SuperscriptBox["\[ExponentialE]", "u"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"4", "+", "a", "-", 
            RowBox[{"3", " ", "b"}]}], ")"}], " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"2", " ", "u"}]]}]}], ")"}], " ", "x"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "a"}], "-", 
         RowBox[{"2", " ", "b"}], "+", 
         RowBox[{"3", " ", "a", " ", "b"}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "a"}], "-", 
            RowBox[{"2", " ", "b"}], "+", 
            RowBox[{"5", " ", "a", " ", "b"}]}], ")"}], " ", 
          SuperscriptBox["\[ExponentialE]", "u"]}], "+", 
         RowBox[{"3", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "b"}], ")"}]}], "+", 
            RowBox[{"2", " ", "b"}]}], ")"}], " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"2", " ", "u"}]]}]}], ")"}], " ", 
       SuperscriptBox["x", "2"]}]}], ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.601801580758153*^9, 3.601801670876574*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"For", " ", "x"}], "\[Rule]", 
   RowBox[{"0", " ", "do", " ", "taylor", " ", "expansion"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.599919913913638*^9, 3.5999199256784573`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ksmallx", " ", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Series", "[", 
    RowBox[{"k", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "2"}], "}"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.599910477269651*^9, 3.5999105916671247`*^9}, {
  3.599910622404003*^9, 3.599910628531685*^9}, {3.599919002195203*^9, 
  3.599919015112321*^9}, {3.599919084932213*^9, 3.5999190908839407`*^9}, {
  3.599919443840901*^9, 3.5999194507290297`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "200"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[ExponentialE]", "4"]}], ")"}]}], "+", 
     RowBox[{"b", " ", 
      RowBox[{"(", 
       RowBox[{"399", "+", 
        SuperscriptBox["\[ExponentialE]", "4"]}], ")"}]}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"-", "400"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[ExponentialE]", "4"]}], ")"}]}], "+", 
     RowBox[{"2", " ", "b", " ", 
      RowBox[{"(", 
       RowBox[{"199", "+", 
        SuperscriptBox["\[ExponentialE]", "4"]}], ")"}]}]}]], "+", 
   FractionBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "200"}], "+", "b"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[ExponentialE]", "4"]}], ")"}], "2"], " ", "x"}], 
    RowBox[{"4", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "200"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["\[ExponentialE]", "4"]}], ")"}]}], "+", 
        RowBox[{"b", " ", 
         RowBox[{"(", 
          RowBox[{"199", "+", 
           SuperscriptBox["\[ExponentialE]", "4"]}], ")"}]}]}], ")"}], 
      "2"]}]], "+", 
   FractionBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "200"}], "+", "b"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[ExponentialE]", "4"]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "200"}], " ", 
        SuperscriptBox["\[ExponentialE]", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["\[ExponentialE]", "4"]}], ")"}]}], "+", 
       RowBox[{"15840000", " ", 
        SuperscriptBox["b", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"199", "+", 
          SuperscriptBox["\[ExponentialE]", "4"]}], ")"}]}], "+", 
       RowBox[{"197", " ", 
        SuperscriptBox["b", "3"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"199", "+", 
           SuperscriptBox["\[ExponentialE]", "4"]}], ")"}], "2"]}], "+", 
       RowBox[{"b", " ", 
        RowBox[{"(", 
         RowBox[{"3160120000", "-", 
          RowBox[{"3152239201", " ", 
           SuperscriptBox["\[ExponentialE]", "4"]}], "-", 
          RowBox[{"7879999", " ", 
           SuperscriptBox["\[ExponentialE]", "8"]}]}], ")"}]}]}], ")"}], " ", 
     
     SuperscriptBox["x", "2"]}], 
    RowBox[{"24", " ", 
     SuperscriptBox["\[ExponentialE]", "4"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "200"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["\[ExponentialE]", "4"]}], ")"}]}], "+", 
        RowBox[{"b", " ", 
         RowBox[{"(", 
          RowBox[{"199", "+", 
           SuperscriptBox["\[ExponentialE]", "4"]}], ")"}]}]}], ")"}], 
      "3"]}]], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "x", "]"}], "3"],
    SeriesData[$CellContext`x, 0, {}, 0, 3, 1],
    Editable->False]}],
  SeriesData[$CellContext`x, 
   0, {((-400) (-1 + E^4) + 
      2 $CellContext`b (199 + E^4))^(-1) ((-200) (-1 + E^4) + $CellContext`b (
       399 + E^4)), 
    Rational[1, 4] (-200 + $CellContext`b)^2 (-1 + 
      E^4)^2 ((-200) (-1 + E^4) + $CellContext`b (199 + E^4))^(-2), 
    Rational[1, 24] (-200 + $CellContext`b)^2 
    E^(-4) (-1 + 
      E^4)^2 ((-200) (-1 + E^4) + $CellContext`b (199 + E^4))^(-3) ((-200) 
      E^4 (-1 + E^4) + 15840000 $CellContext`b^2 (199 + E^4) + 
     197 $CellContext`b^3 (199 + E^4)^2 + $CellContext`b (3160120000 - 
       3152239201 E^4 - 7879999 E^8))}, 0, 3, 1],
  Editable->False]], "Output",
 CellChangeTimes->{
  3.59991059628763*^9, 3.599910629097836*^9, 3.59991901598412*^9, {
   3.599919076060862*^9, 3.599919091319976*^9}, 3.599919513816065*^9, 
   3.599919579396523*^9, 3.5999219068845387`*^9, 3.600425727653858*^9, 
   3.601019085278973*^9, 3.601462078594906*^9, 3.602827325900628*^9, 
   3.602844314870883*^9, 3.6034566952473288`*^9, 3.603461898716367*^9, 
   3.603518442026936*^9, 3.603540396032915*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"fksmallx", "[", 
   RowBox[{"a_", ",", "b_", ",", "u_", ",", "x_"}], "]"}], " ", ":=", 
  RowBox[{
   FractionBox[
    RowBox[{"b", "-", 
     RowBox[{"b", " ", 
      SuperscriptBox["\[ExponentialE]", "u"]}], "+", 
     RowBox[{"a", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "-", 
        RowBox[{"2", " ", "b"}], "+", 
        SuperscriptBox["\[ExponentialE]", "u"]}], ")"}]}]}], 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"b", "-", 
       RowBox[{"b", " ", 
        SuperscriptBox["\[ExponentialE]", "u"]}], "+", 
       RowBox[{"a", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "-", "b", "+", 
          SuperscriptBox["\[ExponentialE]", "u"]}], ")"}]}]}], ")"}]}]], "+", 
   
   FractionBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"a", "-", "b"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[ExponentialE]", "u"]}], ")"}], "2"], " ", "x"}], 
    RowBox[{"4", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "b", "-", 
           SuperscriptBox["\[ExponentialE]", "u"]}], ")"}]}], "+", 
        RowBox[{"b", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["\[ExponentialE]", "u"]}], ")"}]}]}], ")"}], 
      "2"]}]], "+", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"24", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"b", "-", 
         RowBox[{"b", " ", 
          SuperscriptBox["\[ExponentialE]", "u"]}], "+", 
         RowBox[{"a", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "-", "b", "+", 
            SuperscriptBox["\[ExponentialE]", "u"]}], ")"}]}]}], ")"}], 
       "3"]}]], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"a", "-", "b"}], ")"}], "2"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", "u"}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["\[ExponentialE]", "u"]}], ")"}], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       SuperscriptBox["a", "4"], " ", "b", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "b", "-", 
         SuperscriptBox["\[ExponentialE]", "u"]}], ")"}]}], "-", 
      RowBox[{
       SuperscriptBox["a", "3"], " ", "b", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "5"}], "+", 
         SuperscriptBox["b", "2"], "+", 
         RowBox[{"6", " ", 
          SuperscriptBox["\[ExponentialE]", "u"]}], "-", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "u"}]], "+", 
         RowBox[{"2", " ", "b", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "3"}], "+", 
            SuperscriptBox["\[ExponentialE]", "u"]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{"b", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["\[ExponentialE]", "u"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["\[ExponentialE]", "u"]}], "+", 
         RowBox[{"3", " ", 
          SuperscriptBox["b", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["\[ExponentialE]", "u"]}], ")"}]}]}], ")"}]}], "-", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", "b", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "4"}], " ", "b", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["\[ExponentialE]", "u"]}], ")"}]}], "+", 
         RowBox[{"3", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["\[ExponentialE]", "u"]}], ")"}], "2"]}], "+", 
         RowBox[{
          SuperscriptBox["b", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "5"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["\[ExponentialE]", "u"]}]}], ")"}]}]}], ")"}]}], 
      "-", 
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", " ", "b", " ", 
          SuperscriptBox["\[ExponentialE]", "u"]}], "-", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", "u"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["\[ExponentialE]", "u"]}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["b", "3"], " ", 
          RowBox[{"(", 
           RowBox[{"7", "-", 
            RowBox[{"8", " ", 
             SuperscriptBox["\[ExponentialE]", "u"]}], "+", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"2", " ", "u"}]]}], ")"}]}]}], ")"}]}]}], ")"}], " ", 
    SuperscriptBox["x", "2"]}]}]}]], "Input",
 CellChangeTimes->{{3.59991929563583*^9, 3.5999193208299627`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"r1", " ", "=", " ", 
   RowBox[{"-", "0.2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r2", " ", "=", " ", "2.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t", " ", "=", " ", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", " ", "=", " ", 
   RowBox[{"1", "+", "t"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", " ", "=", " ", 
   RowBox[{"1", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"g", "+", "1"}], ")"}], "t"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", " ", "=", " ", 
   RowBox[{"-", "10"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dr", " ", "=", " ", "0.02"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rmin", " ", "=", " ", 
   RowBox[{"-", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rmax", " ", "=", " ", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tab1", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"10", "^", "r"}], ",", " ", 
       RowBox[{
        RowBox[{"fk", "[", 
         RowBox[{"a", ",", "b", ",", "u", ",", 
          RowBox[{"10", "^", 
           RowBox[{"-", "r"}]}]}], "]"}], "/", 
        RowBox[{"klim0", "[", 
         RowBox[{"a", ",", "b", ",", "u"}], "]"}]}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"r", ",", "rmin", ",", " ", "rmax", ",", "dr"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tab2", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"N", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"10", "^", "r"}], ",", " ", 
        RowBox[{
         RowBox[{"fksmallx", "[", 
          RowBox[{"a", ",", "b", ",", "u", ",", 
           RowBox[{"10", "^", 
            RowBox[{"-", "r"}]}]}], "]"}], "/", 
         RowBox[{"klim0", "[", 
          RowBox[{"a", ",", "b", ",", "u"}], "]"}]}]}], "}"}], "]"}], ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"r", ",", "r2", ",", " ", "rmax", ",", "dr"}], "}"}]}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tab3", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"N", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"10", "^", "r"}], ",", " ", 
        RowBox[{
         RowBox[{"fklargex", "[", 
          RowBox[{"a", ",", "b", ",", "u", ",", 
           RowBox[{"10", "^", 
            RowBox[{"-", "r"}]}]}], "]"}], "/", 
         RowBox[{"klim0", "[", 
          RowBox[{"a", ",", "b", ",", "u"}], "]"}]}]}], "}"}], "]"}], ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"r", ",", "rmin", ",", " ", "r1", ",", "dr"}], "}"}]}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"\"\<arate\>\"", "<>", 
     RowBox[{"ToString", "[", "t", "]"}], "<>", "\"\<.tsv\>\""}], ",", " ", 
    "tab1", ",", " ", "\"\<TSV\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"\"\<asrate\>\"", "<>", 
     RowBox[{"ToString", "[", "t", "]"}], "<>", "\"\<.tsv\>\""}], ",", "tab2",
     ",", " ", "\"\<TSV\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"\"\<alrate\>\"", "<>", 
     RowBox[{"ToString", "[", "t", "]"}], "<>", "\"\<.tsv\>\""}], ",", "tab3",
     ",", " ", "\"\<TSV\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "a", ",", "b", ",", "u", ",", "dr", ",", " ", "rmin", ",", " ", "rmax", 
    ",", " ", "r1", ",", " ", "r2", ",", "g", ",", "t"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.602869606960421*^9, 3.602869949395659*^9}, {
   3.602869982086505*^9, 3.602869986667568*^9}, {3.602870049564612*^9, 
   3.602870194282312*^9}, {3.602870419177009*^9, 3.602870435125713*^9}, {
   3.602870482083555*^9, 3.602870484383062*^9}, {3.602870815742386*^9, 
   3.602870834892419*^9}, {3.602870890512837*^9, 3.602870905655993*^9}, {
   3.602870955912126*^9, 3.602870970632444*^9}, {3.602871364153425*^9, 
   3.602871372648065*^9}, {3.60287221445036*^9, 3.602872218339377*^9}, {
   3.60287234158882*^9, 3.602872367692385*^9}, {3.602872405034931*^9, 
   3.602872408155276*^9}, {3.602872451871937*^9, 3.602872457218343*^9}, {
   3.602872518705924*^9, 3.602872592772727*^9}, {3.602872644424082*^9, 
   3.602872646320343*^9}, {3.602872714254717*^9, 3.602872714319902*^9}, {
   3.602872765286673*^9, 3.60287278107918*^9}, {3.602872835298345*^9, 
   3.602872851818579*^9}, {3.602872886293656*^9, 3.60287293540013*^9}, {
   3.603519935913823*^9, 3.6035199407095547`*^9}, {3.603520132891972*^9, 
   3.6035201341032467`*^9}, {3.603520165176155*^9, 3.603520173796866*^9}, {
   3.60352040425393*^9, 3.603520445481654*^9}, {3.603520549310305*^9, 
   3.603520576563489*^9}, {3.603520728096015*^9, 3.603520809392069*^9}, {
   3.603520847251584*^9, 3.603520863922267*^9}, {3.6035228184047728`*^9, 
   3.603522858184249*^9}, {3.603522900986182*^9, 3.603522954551263*^9}, {
   3.603522989326005*^9, 3.6035229901693783`*^9}, {3.6035230259219503`*^9, 
   3.60352305081369*^9}, {3.603523119844255*^9, 3.603523121224823*^9}, {
   3.6035250749647503`*^9, 3.603525077306267*^9}, {3.6035254163557043`*^9, 
   3.603525421999742*^9}, {3.603525499321348*^9, 3.603525574225708*^9}, {
   3.6035257098669567`*^9, 3.603525722421908*^9}, {3.603526386309835*^9, 
   3.603526415935367*^9}, {3.603526651585677*^9, 3.603526656185766*^9}, {
   3.603526692114962*^9, 3.603526750868294*^9}, {3.60352690599086*^9, 
   3.603526934433572*^9}, {3.603527195121984*^9, 3.603527261076207*^9}, {
   3.6035273914695587`*^9, 3.60352743558136*^9}, {3.603527480080824*^9, 
   3.6035275190942173`*^9}, {3.603527647203907*^9, 3.603527703635167*^9}, {
   3.603530604435256*^9, 3.6035306406380587`*^9}, {3.60353068529395*^9, 
   3.603530713371654*^9}, {3.60353076372523*^9, 3.6035307994027023`*^9}, 
   3.603530846310898*^9, {3.603530891672408*^9, 3.603530891736381*^9}, {
   3.603531422512907*^9, 3.6035314239251757`*^9}, {3.603531517722911*^9, 
   3.6035315481496763`*^9}, {3.603531582665657*^9, 3.603531584883593*^9}, {
   3.603531615955961*^9, 3.60353161914671*^9}, {3.6035317309818907`*^9, 
   3.603531731842124*^9}, {3.6035317991313267`*^9, 3.603531863672062*^9}, {
   3.6035318980608664`*^9, 3.6035319196332293`*^9}, {3.60353202699599*^9, 
   3.603532122231894*^9}, {3.603532245505728*^9, 3.603532333837283*^9}, {
   3.603532557950788*^9, 3.603532578713077*^9}, {3.603532625369638*^9, 
   3.603532625652526*^9}, {3.603532660733761*^9, 3.6035327205716887`*^9}, {
   3.60353275439333*^9, 3.603532755408978*^9}, {3.603532789575219*^9, 
   3.603532803501133*^9}, {3.603532929384101*^9, 3.6035329589422607`*^9}, {
   3.603533010361375*^9, 3.60353305415707*^9}, {3.603535625223111*^9, 
   3.603535739329369*^9}, {3.603546655702812*^9, 3.603546664267668*^9}, {
   3.603547141028797*^9, 3.603547343574245*^9}, {3.603547435553608*^9, 
   3.603547507337453*^9}, {3.6035476180286217`*^9, 3.603547622131146*^9}, {
   3.603547657997971*^9, 3.603547704477582*^9}, {3.607258246844021*^9, 
   3.607258272807709*^9}}]
},
WindowSize->{1018, 714},
WindowMargins->{{Automatic, -5}, {Automatic, -8}},
FrontEndVersion->"9.0 for Linux x86 (32-bit) (February 7, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 232, 5, 32, "Input"],
Cell[792, 27, 1030, 16, 55, "Input"],
Cell[1825, 45, 678, 13, 77, "Input"],
Cell[2506, 60, 184, 4, 32, "Input"],
Cell[2693, 66, 465, 13, 32, "Input"],
Cell[3161, 81, 584, 11, 55, "Input"],
Cell[CellGroupData[{
Cell[3770, 96, 300, 9, 32, "Input"],
Cell[4073, 107, 708, 15, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4818, 127, 564, 14, 32, "Input"],
Cell[5385, 143, 1065, 26, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6487, 174, 597, 13, 32, "Input"],
Cell[7087, 189, 1067, 26, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8191, 220, 303, 6, 32, "Input"],
Cell[8497, 228, 3016, 48, 32, "Output"]
}, Open  ]],
Cell[11528, 279, 185, 4, 32, "Input"],
Cell[CellGroupData[{
Cell[11738, 287, 486, 12, 32, "Input"],
Cell[12227, 301, 914, 18, 32, "Output"]
}, Open  ]],
Cell[13156, 322, 333, 7, 32, "Input"],
Cell[CellGroupData[{
Cell[13514, 333, 1813, 46, 124, "Input"],
Cell[15330, 381, 3020, 50, 50, "Output"]
}, Open  ]],
Cell[18365, 434, 279, 6, 32, "Input"],
Cell[18647, 442, 4374, 114, 143, "Input"],
Cell[23024, 558, 423, 9, 32, "Input"],
Cell[23450, 569, 430, 10, 32, "Input"],
Cell[23883, 581, 239, 5, 32, "Input"],
Cell[24125, 588, 1373, 29, 55, "Input"],
Cell[25501, 619, 507, 12, 32, "Input"],
Cell[26011, 633, 253, 7, 32, "Input"],
Cell[26267, 642, 211, 5, 32, "Input"],
Cell[26481, 649, 340, 9, 32, "Input"],
Cell[26824, 660, 375, 10, 32, "Input"],
Cell[27202, 672, 239, 5, 32, "Input"],
Cell[27444, 679, 324, 9, 32, "Input"],
Cell[27771, 690, 351, 10, 32, "Input"],
Cell[28125, 702, 711, 18, 77, "Input"],
Cell[28839, 722, 212, 5, 32, "Input"],
Cell[CellGroupData[{
Cell[29076, 731, 407, 10, 32, "Input"],
Cell[29486, 743, 487, 8, 37, "Output"]
}, Open  ]],
Cell[29988, 754, 171, 3, 32, "Input"],
Cell[30162, 759, 867, 24, 77, "Input"],
Cell[31032, 785, 1098, 35, 77, "Input"],
Cell[32133, 822, 94, 1, 32, "Input"],
Cell[32230, 825, 531, 9, 55, "Input"],
Cell[32764, 836, 239, 6, 32, "Input"],
Cell[33006, 844, 700, 12, 32, "Input"],
Cell[33709, 858, 241, 5, 32, "Input"],
Cell[33953, 865, 15977, 491, 417, "Input"],
Cell[49933, 1358, 268, 7, 32, "Input"],
Cell[CellGroupData[{
Cell[50226, 1369, 415, 9, 32, "Input"],
Cell[50644, 1380, 839, 24, 53, "Output"]
}, Open  ]],
Cell[51498, 1407, 1037, 29, 60, "Input"],
Cell[52538, 1438, 853, 19, 77, "Input"],
Cell[CellGroupData[{
Cell[53416, 1461, 3834, 119, 160, "Input"],
Cell[57253, 1582, 2470, 74, 85, "Output"]
}, Open  ]],
Cell[59738, 1659, 229, 5, 32, "Input"],
Cell[CellGroupData[{
Cell[59992, 1668, 2513, 75, 85, "Input"],
Cell[62508, 1745, 1046, 27, 53, "Output"]
}, Open  ]],
Cell[63569, 1775, 815, 25, 60, "Input"],
Cell[64387, 1802, 204, 5, 32, "Input"],
Cell[64594, 1809, 624, 18, 32, "Input"],
Cell[CellGroupData[{
Cell[65243, 1831, 715, 20, 77, "Input"],
Cell[65961, 1853, 1601, 27, 32, "Output"]
}, Open  ]],
Cell[67577, 1883, 670, 14, 77, "Input"],
Cell[68250, 1899, 400, 10, 32, "Input"],
Cell[68653, 1911, 391, 8, 55, "Input"],
Cell[CellGroupData[{
Cell[69069, 1923, 2492, 75, 107, "Input"],
Cell[71564, 2000, 2095, 64, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73696, 2069, 780, 24, 35, "Input"],
Cell[74479, 2095, 1243, 32, 37, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[75759, 2132, 1680, 52, 62, "Input"],
Cell[77442, 2186, 1493, 42, 62, "Output"]
}, Open  ]],
Cell[78950, 2231, 300, 7, 32, "Input"],
Cell[79253, 2240, 3122, 84, 132, "Input"],
Cell[82378, 2326, 235, 6, 32, "Input"],
Cell[CellGroupData[{
Cell[82638, 2336, 482, 10, 32, "Input"],
Cell[83123, 2348, 4564, 132, 116, "Output"]
}, Open  ]],
Cell[87702, 2483, 5190, 156, 171, "Input"],
Cell[92895, 2641, 7183, 155, 385, "Input"]
}
]
*)

(* End of internal cache information *)

(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[      9970,        301]
NotebookOptionsPosition[      9538,        282]
NotebookOutlinePosition[      9875,        297]
CellTagsIndexPosition[      9832,        294]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"d", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w12", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w21", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U01", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U02", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rsink", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rmax", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t0", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t1", "=", "10"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"u1", "[", "r_", "]"}], ":=", 
   RowBox[{"U01", " ", 
    RowBox[{"Exp", "[", 
     RowBox[{"-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"r", "-", "a"}], ")"}], "/", "b"}], ")"}], "^", "n"}]}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"u2", "[", "r_", "]"}], ":=", 
   RowBox[{"U02", " ", 
    RowBox[{"Exp", "[", 
     RowBox[{"-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"r", "-", "a"}], ")"}], "/", "b"}], ")"}], "^", "n"}]}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pde", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"\[Rho]1", "[", 
         RowBox[{"r", ",", "t"}], "]"}], ",", "t"}], "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{
        RowBox[{"2", "/", "r"}], " ", 
        RowBox[{"\[Rho]1", "[", 
         RowBox[{"r", ",", "t"}], "]"}], " ", 
        RowBox[{
         RowBox[{"u1", "'"}], "[", "r", "]"}]}], "+", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"\[Rho]1", "[", 
           RowBox[{"r", ",", "t"}], "]"}], ",", "r"}], "]"}], 
        RowBox[{
         RowBox[{"u1", "'"}], "[", "r", "]"}]}], "+", 
       RowBox[{
        RowBox[{"\[Rho]1", "[", 
         RowBox[{"r", ",", "t"}], "]"}], " ", 
        RowBox[{
         RowBox[{"u1", "''"}], "[", "r", "]"}]}], "+", 
       RowBox[{"d", " ", 
        RowBox[{"2", "/", "r"}], " ", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"\[Rho]1", "[", 
           RowBox[{"r", ",", "t"}], "]"}], ",", "r"}], "]"}]}], "+", 
       RowBox[{"d", " ", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"\[Rho]1", "[", 
           RowBox[{"r", ",", "t"}], "]"}], ",", "r", ",", "r"}], "]"}]}], "-", 
       RowBox[{"w12", " ", 
        RowBox[{"\[Rho]1", "[", 
         RowBox[{"r", ",", "t"}], "]"}]}], " ", "+", " ", 
       RowBox[{"w21", " ", 
        RowBox[{"\[Rho]2", "[", 
         RowBox[{"r", ",", "t"}], "]"}]}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"\[Rho]2", "[", 
         RowBox[{"r", ",", "t"}], "]"}], ",", "t"}], "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{
        RowBox[{"2", "/", "r"}], " ", 
        RowBox[{"\[Rho]2", "[", 
         RowBox[{"r", ",", "t"}], "]"}], " ", 
        RowBox[{
         RowBox[{"u2", "'"}], "[", "r", "]"}]}], "+", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"\[Rho]2", "[", 
           RowBox[{"r", ",", "t"}], "]"}], ",", "r"}], "]"}], 
        RowBox[{
         RowBox[{"u2", "'"}], "[", "r", "]"}]}], "+", 
       RowBox[{
        RowBox[{"\[Rho]2", "[", 
         RowBox[{"r", ",", "t"}], "]"}], " ", 
        RowBox[{
         RowBox[{"u2", "''"}], "[", "r", "]"}]}], "+", 
       RowBox[{"d", " ", 
        RowBox[{"2", "/", "r"}], " ", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"\[Rho]2", "[", 
           RowBox[{"r", ",", "t"}], "]"}], ",", "r"}], "]"}]}], "+", 
       RowBox[{"d", " ", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"\[Rho]2", "[", 
           RowBox[{"r", ",", "t"}], "]"}], ",", "r", ",", "r"}], "]"}]}], "-", 
       RowBox[{"w21", " ", 
        RowBox[{"\[Rho]2", "[", 
         RowBox[{"r", ",", "t"}], "]"}]}], " ", "+", " ", 
       RowBox[{"w12", " ", 
        RowBox[{"\[Rho]1", "[", 
         RowBox[{"r", ",", "t"}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bc", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Rho]1", "[", 
       RowBox[{"Rsink", ",", "t"}], "]"}], "\[Equal]", "0"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Rho]2", "[", 
       RowBox[{"Rsink", ",", "t"}], "]"}], "\[Equal]", "0"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Rho]1", "[", 
       RowBox[{"Rmax", ",", "t"}], "]"}], "\[Equal]", 
      RowBox[{"w21", "/", 
       RowBox[{"(", 
        RowBox[{"w12", "+", "w21"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Rho]2", "[", 
       RowBox[{"Rmax", ",", "t"}], "]"}], "\[Equal]", 
      RowBox[{"w12", "/", 
       RowBox[{"(", 
        RowBox[{"w12", "+", "w21"}], ")"}]}]}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ic", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Rho]1", "[", 
       RowBox[{"r", ",", "t0"}], "]"}], "\[Equal]", 
      RowBox[{"w21", "/", 
       RowBox[{"(", 
        RowBox[{"w12", "+", "w21"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Rho]2", "[", 
       RowBox[{"r", ",", "t0"}], "]"}], "\[Equal]", 
      RowBox[{"w12", "/", 
       RowBox[{"(", 
        RowBox[{"w12", "+", "w21"}], ")"}]}]}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.606133802022723*^9, 3.606133894434197*^9}, {
  3.606133954743721*^9, 3.60613410942947*^9}, {3.606134240403104*^9, 
  3.606134457721407*^9}, {3.60613451239788*^9, 3.606134712725695*^9}, {
  3.606134791643445*^9, 3.606134862164114*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NDSolve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"pde", ",", "bc", ",", "ic"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Rho]1", ",", "\[Rho]2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "t0", ",", "t1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"r", ",", "Rsink", ",", "Rmax"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.606134870694799*^9, 3.606134920267049*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NDSolve", "::", "ibcinc"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Warning: boundary and initial conditions are inconsistent. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/NDSolve/ibcinc\\\", \
ButtonNote -> \\\"NDSolve::ibcinc\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.606134920929038*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NDSolve", "::", "eerr"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Warning: scaled local spatial error estimate of \[NoBreak]\
\\!\\(1189.151545812981`\\)\[NoBreak] at \[NoBreak]\\!\\(t\\)\[NoBreak] = \
\[NoBreak]\\!\\(10.`\\)\[NoBreak] in the direction of independent variable \
\[NoBreak]\\!\\(r\\)\[NoBreak] is much greater than the prescribed error \
tolerance. Grid spacing with \[NoBreak]\\!\\(25\\)\[NoBreak] points may be \
too large to achieve the desired accuracy or precision. A singularity may \
have formed or a smaller grid spacing can be specified using the MaxStepSize \
or MinPoints method options. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/NDSolve/eerr\\\", ButtonNote -> \
\\\"NDSolve::eerr\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.606134921986855*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Rho]1", "\[Rule]", 
     TagBox[
      RowBox[{"InterpolatingFunction", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1.`", ",", "10.`"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.`", ",", "10.`"}], "}"}]}], "}"}], ",", "\<\"<>\"\>"}], 
       "]"}],
      False,
      Editable->False]}], ",", 
    RowBox[{"\[Rho]2", "\[Rule]", 
     TagBox[
      RowBox[{"InterpolatingFunction", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1.`", ",", "10.`"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.`", ",", "10.`"}], "}"}]}], "}"}], ",", "\<\"<>\"\>"}], 
       "]"}],
      False,
      Editable->False]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.606134922018933*^9}]
}, Open  ]]
},
WindowSize->{740, 598},
WindowMargins->{{118, Automatic}, {Automatic, -8}},
FrontEndVersion->"9.0 for Linux x86 (32-bit) (February 7, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 6242, 183, 737, "Input"],
Cell[CellGroupData[{
Cell[6824, 207, 420, 11, 32, "Input"],
Cell[7247, 220, 444, 9, 24, "Message"],
Cell[7694, 231, 928, 16, 118, "Message"],
Cell[8625, 249, 897, 30, 112, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)


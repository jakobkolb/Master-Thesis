(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     10774,        294]
NotebookOptionsPosition[     10270,        273]
NotebookOutlinePosition[     10605,        288]
CellTagsIndexPosition[     10562,        285]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{
  "equations", ",", "u1", ",", "u2", ",", "l", ",", "g", ",", "w12", ",", 
   "w21", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", "rd"}], "]"}]], "Input",
 CellChangeTimes->{{3.605961438661627*^9, 3.60596146874695*^9}, {
  3.605962751107139*^9, 3.60596275183512*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"equations", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"0", "==", 
       RowBox[{
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"r", "^", "2"}]}], "*", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"r", "^", "2"}], "*", 
            RowBox[{"\[Rho]1", "[", "r", "]"}], "*", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"u1", "[", "r", "]"}], ",", "r"}], "]"}]}], ",", "r"}], 
          "]"}]}], "+", 
        RowBox[{"d", "*", 
         RowBox[{"1", "/", 
          RowBox[{"r", "^", "2"}]}], "*", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"r", "^", "2"}], "*", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"\[Rho]1", "[", "r", "]"}], ",", "r"}], "]"}]}], ",", 
           "r"}], "]"}]}], "-", 
        RowBox[{"w12", "*", 
         RowBox[{"\[Rho]1", "[", "r", "]"}]}], "+", 
        RowBox[{"w21", "*", 
         RowBox[{"\[Rho]2", "[", "r", "]"}]}]}]}], ",", 
      RowBox[{"0", "==", 
       RowBox[{
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"r", "^", "2"}]}], "*", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"r", "^", "2"}], "*", 
            RowBox[{"\[Rho]2", "[", "r", "]"}], "*", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"u2", "[", "r", "]"}], ",", "r"}], "]"}]}], ",", "r"}], 
          "]"}]}], "+", 
        RowBox[{"d", "*", 
         RowBox[{"1", "/", 
          RowBox[{"r", "^", "2"}]}], "*", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"r", "^", "2"}], "*", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"\[Rho]2", "[", "r", "]"}], ",", "r"}], "]"}]}], ",", 
           "r"}], "]"}]}], "-", 
        RowBox[{"w21", "*", 
         RowBox[{"\[Rho]2", "[", "r", "]"}]}], "+", 
        RowBox[{"w12", "*", 
         RowBox[{"\[Rho]1", "[", "r", "]"}]}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Rho]1", "[", "1", "]"}], "\[Equal]", "0"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Rho]2", "[", "1", "]"}], "\[Equal]", "0"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Rho]1", "[", "rd", "]"}], "\[Equal]", 
       RowBox[{"w21", "/", 
        RowBox[{"(", 
         RowBox[{"w12", "+", "w21"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Rho]2", "[", "rd", "]"}], "\[Equal]", 
       RowBox[{"w12", "/", 
        RowBox[{"(", 
         RowBox[{"w12", "+", "w21"}], ")"}]}]}]}], "\[IndentingNewLine]", 
     "}"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.605953245802219*^9, 3.605953253234821*^9}, {
   3.605953431715942*^9, 3.605953444647011*^9}, {3.605953499608795*^9, 
   3.605953565031051*^9}, {3.605953605471462*^9, 3.605953606453787*^9}, {
   3.605953969706158*^9, 3.605954008305015*^9}, {3.605954038786899*^9, 
   3.605954087759113*^9}, {3.605954141711848*^9, 3.605954165253574*^9}, {
   3.605954684307891*^9, 3.605954963369161*^9}, {3.60595499468631*^9, 
   3.605955051541054*^9}, {3.605955114907029*^9, 3.605955210975536*^9}, {
   3.60595686940896*^9, 3.605956898570025*^9}, {3.605956950644066*^9, 
   3.605956952091078*^9}, 3.605957207924476*^9, {3.605960817372306*^9, 
   3.605960818797518*^9}, 3.605961236763644*^9, {3.605961315903483*^9, 
   3.605961356542693*^9}, 3.605961429547655*^9, {3.605962006099616*^9, 
   3.605962071645525*^9}, {3.605962685943386*^9, 3.605962692623686*^9}, {
   3.605962768172161*^9, 3.605962771076348*^9}, 3.60596281926253*^9, {
   3.605962855341146*^9, 3.605962933326832*^9}, {3.605963079883129*^9, 
   3.605963103398815*^9}, {3.605963198490487*^9, 3.60596322809366*^9}, {
   3.605963269024867*^9, 3.605963285539899*^9}, {3.60596339607847*^9, 
   3.605963494851895*^9}, 3.605963558976742*^9, 3.605963596986911*^9, {
   3.60596492977399*^9, 3.60596504775932*^9}, {3.605966326125254*^9, 
   3.605966327347648*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"u1", "[", "r_", "]"}], ":=", " ", 
  RowBox[{"Piecewise", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"r", "<=", 
        RowBox[{"1", "+", "l"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Alpha]1", "*", "r"}], ",", 
       RowBox[{
        RowBox[{"r", ">", 
         RowBox[{"1", "+", "l"}]}], " ", "&&", " ", 
        RowBox[{"r", "<=", 
         RowBox[{"1", "+", "l", "+", 
          RowBox[{"l", "*", 
           RowBox[{"g", "/", "2"}]}]}]}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[Alpha]1"}], "*", "r"}], ",", 
       RowBox[{
        RowBox[{"r", ">", 
         RowBox[{"1", "+", "l", "+", 
          RowBox[{"l", "*", 
           RowBox[{"g", "/", "2"}]}]}]}], "&&", 
        RowBox[{"r", "<=", 
         RowBox[{"1", "+", "l", "+", 
          RowBox[{"l", "*", "g"}]}]}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"r", ">", 
        RowBox[{"1", "+", "l", "+", 
         RowBox[{"l", "*", "g"}]}]}]}], "}"}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.605953359449655*^9, 3.605953375329224*^9}, {
  3.605956964569882*^9, 3.605956981975444*^9}, {3.605957235259952*^9, 
  3.605957246019948*^9}, {3.60595729773127*^9, 3.60595730717188*^9}, {
  3.605959887382358*^9, 3.605959992113532*^9}, {3.605960737705296*^9, 
  3.605960805729285*^9}, {3.605963004831268*^9, 3.60596301664618*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"u2", "[", "r_", "]"}], ":=", " ", 
  RowBox[{"Piecewise", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"r", "<=", 
        RowBox[{"1", "+", "l"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Alpha]2", "*", "r"}], ",", 
       RowBox[{
        RowBox[{"r", ">", 
         RowBox[{"1", "+", "l"}]}], " ", "&&", " ", 
        RowBox[{"r", "<=", 
         RowBox[{"1", "+", "l", "+", 
          RowBox[{"l", "*", 
           RowBox[{"g", "/", "2"}]}]}]}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[Alpha]2"}], "*", "r"}], ",", 
       RowBox[{
        RowBox[{"r", ">", 
         RowBox[{"1", "+", "l", "+", 
          RowBox[{"l", "*", 
           RowBox[{"g", "/", "2"}]}]}]}], "&&", 
        RowBox[{"r", "<=", 
         RowBox[{"1", "+", "l", "+", 
          RowBox[{"l", "*", "g"}]}]}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"r", ">", 
        RowBox[{"1", "+", "l", "+", 
         RowBox[{"l", "*", "g"}]}]}]}], "}"}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.605960879330476*^9, 3.605960890299643*^9}, {
  3.605963020550663*^9, 3.605963027355467*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"l", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w12", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w21", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]1", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]2", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rd", "=", "5"}], ";"}]}], "Input",
 CellChangeTimes->{{3.605960954218453*^9, 3.605960977929278*^9}, {
  3.605961063333478*^9, 3.605961090158658*^9}, {3.605961262165583*^9, 
  3.605961265316133*^9}, {3.605961390687164*^9, 3.605961419100668*^9}, {
  3.605962081955844*^9, 3.605962082307254*^9}, {3.605963524753298*^9, 
  3.605963526697677*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"NDSolve", "[", 
   RowBox[{"equations", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Rho]1", "[", "r", "]"}], ",", 
      RowBox[{"\[Rho]2", "[", "r", "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"r", ",", "1", ",", "rd"}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.605960846330722*^9, 3.605960852908334*^9}, {
   3.605960899657085*^9, 3.605960945602714*^9}, 3.605961094312675*^9, {
   3.605961267864718*^9, 3.605961270033058*^9}, 3.605962078004947*^9, {
   3.605962785006471*^9, 3.605962801827122*^9}, {3.605964904016321*^9, 
   3.605964911357355*^9}, 3.605966334026564*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NDSolve", "::", "bvdisc"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"NDSolve is not currently able to solve boundary value \
problems with discrete variables. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/NDSolve\\\", ButtonNote -> \
\\\"NDSolve::bvdisc\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.605961103519448*^9, {3.605961245118332*^9, 3.60596127321062*^9}, 
   3.605961327517355*^9, 3.605961359243014*^9, 3.605961422273349*^9, 
   3.605961472759267*^9, 3.605962086179187*^9, {3.605962755981215*^9, 
   3.605962802614363*^9}, {3.605962833973224*^9, 3.605962905068829*^9}, 
   3.60596303325917*^9, 3.605963108985994*^9, 3.60596323304235*^9, 
   3.605963296434735*^9, {3.605963419622713*^9, 3.605963532672516*^9}, 
   3.605963563378841*^9, 3.605963601172826*^9, {3.605964912581726*^9, 
   3.60596491700268*^9}, 3.605965130396401*^9, {3.605966319615209*^9, 
   3.605966337114516*^9}}]
}, Open  ]]
},
WindowSize->{1024, 715},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"9.0 for Linux x86 (32-bit) (February 7, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 312, 6, 32, "Input"],
Cell[872, 28, 4109, 99, 253, "Input"],
Cell[4984, 129, 1497, 41, 77, "Input"],
Cell[6484, 172, 1261, 38, 77, "Input"],
Cell[7748, 212, 806, 19, 165, "Input"],
Cell[CellGroupData[{
Cell[8579, 235, 641, 14, 32, "Input"],
Cell[9223, 251, 1031, 19, 24, "Message"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

